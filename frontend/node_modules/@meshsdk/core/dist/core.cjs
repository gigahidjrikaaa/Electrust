"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const _e=require("nanoid"),Ge=require("@emurgo/cardano-serialization-lib-nodejs"),$e=require("axios"),Nt=require("bip39"),_=require("@emurgo/cardano-message-signing-nodejs"),ze=r=>r&&typeof r=="object"&&"default"in r?r:{default:r};function We(r){if(r&&r.__esModule)return r;const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(r){for(const t in r)if(t!=="default"){const s=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(e,t,s.get?s:{enumerable:!0,get:()=>r[t]})}}return e.default=r,Object.freeze(e)}const n=We(Ge),G=ze($e),Je=["testnet","preview","preprod","mainnet"],ye=r=>Je.includes(r),nt={mem:7e6,steps:3e9},D={epoch:0,coinsPerUTxOSize:"4310",priceMem:.0577,priceStep:721e-7,minFeeA:44,minFeeB:155381,keyDeposit:"2000000",maxTxSize:16384,maxValSize:"5000",poolDeposit:"500000000",maxCollateralInputs:3,decentralisation:0,maxBlockSize:98304,collateralPercent:150,maxBlockHeaderSize:1100,minPoolCost:"340000000",maxTxExMem:"16000000",maxTxExSteps:"10000000000",maxBlockExMem:"80000000",maxBlockExSteps:"40000000000"},Ut=2147483648,q={V1:n.Language.new_plutus_v1(),V2:n.Language.new_plutus_v2()},O=56,je={CERT:n.RedeemerTag.new_cert(),MINT:n.RedeemerTag.new_mint(),REWARD:n.RedeemerTag.new_reward(),SPEND:n.RedeemerTag.new_spend()},Et={testnet:["74","1598400","1595967616","432000"],preview:["183","15811222","1682467200","86400"],preprod:["65","26438400","1682121600","432000"],mainnet:["208","4492800","1596059091","432000"]},Jt={ALONZO:n.TxBuilderConstants.plutus_alonzo_cost_models(),BABBAGE:(()=>{const r=n.Costmdls.new(),e=n.CostModel.new();Object.values({"addInteger-cpu-arguments-intercept":205665,"addInteger-cpu-arguments-slope":812,"addInteger-memory-arguments-intercept":1,"addInteger-memory-arguments-slope":1,"appendByteString-cpu-arguments-intercept":1e3,"appendByteString-cpu-arguments-slope":571,"appendByteString-memory-arguments-intercept":0,"appendByteString-memory-arguments-slope":1,"appendString-cpu-arguments-intercept":1e3,"appendString-cpu-arguments-slope":24177,"appendString-memory-arguments-intercept":4,"appendString-memory-arguments-slope":1,"bData-cpu-arguments":1e3,"bData-memory-arguments":32,"blake2b_256-cpu-arguments-intercept":117366,"blake2b_256-cpu-arguments-slope":10475,"blake2b_256-memory-arguments":4,"cekApplyCost-exBudgetCPU":23e3,"cekApplyCost-exBudgetMemory":100,"cekBuiltinCost-exBudgetCPU":23e3,"cekBuiltinCost-exBudgetMemory":100,"cekConstCost-exBudgetCPU":23e3,"cekConstCost-exBudgetMemory":100,"cekDelayCost-exBudgetCPU":23e3,"cekDelayCost-exBudgetMemory":100,"cekForceCost-exBudgetCPU":23e3,"cekForceCost-exBudgetMemory":100,"cekLamCost-exBudgetCPU":23e3,"cekLamCost-exBudgetMemory":100,"cekStartupCost-exBudgetCPU":100,"cekStartupCost-exBudgetMemory":100,"cekVarCost-exBudgetCPU":23e3,"cekVarCost-exBudgetMemory":100,"chooseData-cpu-arguments":19537,"chooseData-memory-arguments":32,"chooseList-cpu-arguments":175354,"chooseList-memory-arguments":32,"chooseUnit-cpu-arguments":46417,"chooseUnit-memory-arguments":4,"consByteString-cpu-arguments-intercept":221973,"consByteString-cpu-arguments-slope":511,"consByteString-memory-arguments-intercept":0,"consByteString-memory-arguments-slope":1,"constrData-cpu-arguments":89141,"constrData-memory-arguments":32,"decodeUtf8-cpu-arguments-intercept":497525,"decodeUtf8-cpu-arguments-slope":14068,"decodeUtf8-memory-arguments-intercept":4,"decodeUtf8-memory-arguments-slope":2,"divideInteger-cpu-arguments-constant":196500,"divideInteger-cpu-arguments-model-arguments-intercept":453240,"divideInteger-cpu-arguments-model-arguments-slope":220,"divideInteger-memory-arguments-intercept":0,"divideInteger-memory-arguments-minimum":1,"divideInteger-memory-arguments-slope":1,"encodeUtf8-cpu-arguments-intercept":1e3,"encodeUtf8-cpu-arguments-slope":28662,"encodeUtf8-memory-arguments-intercept":4,"encodeUtf8-memory-arguments-slope":2,"equalsByteString-cpu-arguments-constant":245e3,"equalsByteString-cpu-arguments-intercept":216773,"equalsByteString-cpu-arguments-slope":62,"equalsByteString-memory-arguments":1,"equalsData-cpu-arguments-intercept":1060367,"equalsData-cpu-arguments-slope":12586,"equalsData-memory-arguments":1,"equalsInteger-cpu-arguments-intercept":208512,"equalsInteger-cpu-arguments-slope":421,"equalsInteger-memory-arguments":1,"equalsString-cpu-arguments-constant":187e3,"equalsString-cpu-arguments-intercept":1e3,"equalsString-cpu-arguments-slope":52998,"equalsString-memory-arguments":1,"fstPair-cpu-arguments":80436,"fstPair-memory-arguments":32,"headList-cpu-arguments":43249,"headList-memory-arguments":32,"iData-cpu-arguments":1e3,"iData-memory-arguments":32,"ifThenElse-cpu-arguments":80556,"ifThenElse-memory-arguments":1,"indexByteString-cpu-arguments":57667,"indexByteString-memory-arguments":4,"lengthOfByteString-cpu-arguments":1e3,"lengthOfByteString-memory-arguments":10,"lessThanByteString-cpu-arguments-intercept":197145,"lessThanByteString-cpu-arguments-slope":156,"lessThanByteString-memory-arguments":1,"lessThanEqualsByteString-cpu-arguments-intercept":197145,"lessThanEqualsByteString-cpu-arguments-slope":156,"lessThanEqualsByteString-memory-arguments":1,"lessThanEqualsInteger-cpu-arguments-intercept":204924,"lessThanEqualsInteger-cpu-arguments-slope":473,"lessThanEqualsInteger-memory-arguments":1,"lessThanInteger-cpu-arguments-intercept":208896,"lessThanInteger-cpu-arguments-slope":511,"lessThanInteger-memory-arguments":1,"listData-cpu-arguments":52467,"listData-memory-arguments":32,"mapData-cpu-arguments":64832,"mapData-memory-arguments":32,"mkCons-cpu-arguments":65493,"mkCons-memory-arguments":32,"mkNilData-cpu-arguments":22558,"mkNilData-memory-arguments":32,"mkNilPairData-cpu-arguments":16563,"mkNilPairData-memory-arguments":32,"mkPairData-cpu-arguments":76511,"mkPairData-memory-arguments":32,"modInteger-cpu-arguments-constant":196500,"modInteger-cpu-arguments-model-arguments-intercept":453240,"modInteger-cpu-arguments-model-arguments-slope":220,"modInteger-memory-arguments-intercept":0,"modInteger-memory-arguments-minimum":1,"modInteger-memory-arguments-slope":1,"multiplyInteger-cpu-arguments-intercept":69522,"multiplyInteger-cpu-arguments-slope":11687,"multiplyInteger-memory-arguments-intercept":0,"multiplyInteger-memory-arguments-slope":1,"nullList-cpu-arguments":60091,"nullList-memory-arguments":32,"quotientInteger-cpu-arguments-constant":196500,"quotientInteger-cpu-arguments-model-arguments-intercept":453240,"quotientInteger-cpu-arguments-model-arguments-slope":220,"quotientInteger-memory-arguments-intercept":0,"quotientInteger-memory-arguments-minimum":1,"quotientInteger-memory-arguments-slope":1,"remainderInteger-cpu-arguments-constant":196500,"remainderInteger-cpu-arguments-model-arguments-intercept":453240,"remainderInteger-cpu-arguments-model-arguments-slope":220,"remainderInteger-memory-arguments-intercept":0,"remainderInteger-memory-arguments-minimum":1,"remainderInteger-memory-arguments-slope":1,"sha2_256-cpu-arguments-intercept":806990,"sha2_256-cpu-arguments-slope":30482,"sha2_256-memory-arguments":4,"sha3_256-cpu-arguments-intercept":1927926,"sha3_256-cpu-arguments-slope":82523,"sha3_256-memory-arguments":4,"sliceByteString-cpu-arguments-intercept":265318,"sliceByteString-cpu-arguments-slope":0,"sliceByteString-memory-arguments-intercept":4,"sliceByteString-memory-arguments-slope":0,"sndPair-cpu-arguments":85931,"sndPair-memory-arguments":32,"subtractInteger-cpu-arguments-intercept":205665,"subtractInteger-cpu-arguments-slope":812,"subtractInteger-memory-arguments-intercept":1,"subtractInteger-memory-arguments-slope":1,"tailList-cpu-arguments":41182,"tailList-memory-arguments":32,"trace-cpu-arguments":212342,"trace-memory-arguments":32,"unBData-cpu-arguments":31220,"unBData-memory-arguments":32,"unConstrData-cpu-arguments":32696,"unConstrData-memory-arguments":32,"unIData-cpu-arguments":43357,"unIData-memory-arguments":32,"unListData-cpu-arguments":32247,"unListData-memory-arguments":32,"unMapData-cpu-arguments":38314,"unMapData-memory-arguments":32,"verifyEd25519Signature-cpu-arguments-intercept":57996947,"verifyEd25519Signature-cpu-arguments-slope":18975,"verifyEd25519Signature-memory-arguments":10}).forEach((s,a)=>e.set(a,n.Int.new_i32(s)));const t=n.CostModel.new();return Object.values({"addInteger-cpu-arguments-intercept":205665,"addInteger-cpu-arguments-slope":812,"addInteger-memory-arguments-intercept":1,"addInteger-memory-arguments-slope":1,"appendByteString-cpu-arguments-intercept":1e3,"appendByteString-cpu-arguments-slope":571,"appendByteString-memory-arguments-intercept":0,"appendByteString-memory-arguments-slope":1,"appendString-cpu-arguments-intercept":1e3,"appendString-cpu-arguments-slope":24177,"appendString-memory-arguments-intercept":4,"appendString-memory-arguments-slope":1,"bData-cpu-arguments":1e3,"bData-memory-arguments":32,"blake2b_256-cpu-arguments-intercept":117366,"blake2b_256-cpu-arguments-slope":10475,"blake2b_256-memory-arguments":4,"cekApplyCost-exBudgetCPU":23e3,"cekApplyCost-exBudgetMemory":100,"cekBuiltinCost-exBudgetCPU":23e3,"cekBuiltinCost-exBudgetMemory":100,"cekConstCost-exBudgetCPU":23e3,"cekConstCost-exBudgetMemory":100,"cekDelayCost-exBudgetCPU":23e3,"cekDelayCost-exBudgetMemory":100,"cekForceCost-exBudgetCPU":23e3,"cekForceCost-exBudgetMemory":100,"cekLamCost-exBudgetCPU":23e3,"cekLamCost-exBudgetMemory":100,"cekStartupCost-exBudgetCPU":100,"cekStartupCost-exBudgetMemory":100,"cekVarCost-exBudgetCPU":23e3,"cekVarCost-exBudgetMemory":100,"chooseData-cpu-arguments":19537,"chooseData-memory-arguments":32,"chooseList-cpu-arguments":175354,"chooseList-memory-arguments":32,"chooseUnit-cpu-arguments":46417,"chooseUnit-memory-arguments":4,"consByteString-cpu-arguments-intercept":221973,"consByteString-cpu-arguments-slope":511,"consByteString-memory-arguments-intercept":0,"consByteString-memory-arguments-slope":1,"constrData-cpu-arguments":89141,"constrData-memory-arguments":32,"decodeUtf8-cpu-arguments-intercept":497525,"decodeUtf8-cpu-arguments-slope":14068,"decodeUtf8-memory-arguments-intercept":4,"decodeUtf8-memory-arguments-slope":2,"divideInteger-cpu-arguments-constant":196500,"divideInteger-cpu-arguments-model-arguments-intercept":453240,"divideInteger-cpu-arguments-model-arguments-slope":220,"divideInteger-memory-arguments-intercept":0,"divideInteger-memory-arguments-minimum":1,"divideInteger-memory-arguments-slope":1,"encodeUtf8-cpu-arguments-intercept":1e3,"encodeUtf8-cpu-arguments-slope":28662,"encodeUtf8-memory-arguments-intercept":4,"encodeUtf8-memory-arguments-slope":2,"equalsByteString-cpu-arguments-constant":245e3,"equalsByteString-cpu-arguments-intercept":216773,"equalsByteString-cpu-arguments-slope":62,"equalsByteString-memory-arguments":1,"equalsData-cpu-arguments-intercept":1060367,"equalsData-cpu-arguments-slope":12586,"equalsData-memory-arguments":1,"equalsInteger-cpu-arguments-intercept":208512,"equalsInteger-cpu-arguments-slope":421,"equalsInteger-memory-arguments":1,"equalsString-cpu-arguments-constant":187e3,"equalsString-cpu-arguments-intercept":1e3,"equalsString-cpu-arguments-slope":52998,"equalsString-memory-arguments":1,"fstPair-cpu-arguments":80436,"fstPair-memory-arguments":32,"headList-cpu-arguments":43249,"headList-memory-arguments":32,"iData-cpu-arguments":1e3,"iData-memory-arguments":32,"ifThenElse-cpu-arguments":80556,"ifThenElse-memory-arguments":1,"indexByteString-cpu-arguments":57667,"indexByteString-memory-arguments":4,"lengthOfByteString-cpu-arguments":1e3,"lengthOfByteString-memory-arguments":10,"lessThanByteString-cpu-arguments-intercept":197145,"lessThanByteString-cpu-arguments-slope":156,"lessThanByteString-memory-arguments":1,"lessThanEqualsByteString-cpu-arguments-intercept":197145,"lessThanEqualsByteString-cpu-arguments-slope":156,"lessThanEqualsByteString-memory-arguments":1,"lessThanEqualsInteger-cpu-arguments-intercept":204924,"lessThanEqualsInteger-cpu-arguments-slope":473,"lessThanEqualsInteger-memory-arguments":1,"lessThanInteger-cpu-arguments-intercept":208896,"lessThanInteger-cpu-arguments-slope":511,"lessThanInteger-memory-arguments":1,"listData-cpu-arguments":52467,"listData-memory-arguments":32,"mapData-cpu-arguments":64832,"mapData-memory-arguments":32,"mkCons-cpu-arguments":65493,"mkCons-memory-arguments":32,"mkNilData-cpu-arguments":22558,"mkNilData-memory-arguments":32,"mkNilPairData-cpu-arguments":16563,"mkNilPairData-memory-arguments":32,"mkPairData-cpu-arguments":76511,"mkPairData-memory-arguments":32,"modInteger-cpu-arguments-constant":196500,"modInteger-cpu-arguments-model-arguments-intercept":453240,"modInteger-cpu-arguments-model-arguments-slope":220,"modInteger-memory-arguments-intercept":0,"modInteger-memory-arguments-minimum":1,"modInteger-memory-arguments-slope":1,"multiplyInteger-cpu-arguments-intercept":69522,"multiplyInteger-cpu-arguments-slope":11687,"multiplyInteger-memory-arguments-intercept":0,"multiplyInteger-memory-arguments-slope":1,"nullList-cpu-arguments":60091,"nullList-memory-arguments":32,"quotientInteger-cpu-arguments-constant":196500,"quotientInteger-cpu-arguments-model-arguments-intercept":453240,"quotientInteger-cpu-arguments-model-arguments-slope":220,"quotientInteger-memory-arguments-intercept":0,"quotientInteger-memory-arguments-minimum":1,"quotientInteger-memory-arguments-slope":1,"remainderInteger-cpu-arguments-constant":196500,"remainderInteger-cpu-arguments-model-arguments-intercept":453240,"remainderInteger-cpu-arguments-model-arguments-slope":220,"remainderInteger-memory-arguments-intercept":0,"remainderInteger-memory-arguments-minimum":1,"remainderInteger-memory-arguments-slope":1,"serialiseData-cpu-arguments-intercept":1159724,"serialiseData-cpu-arguments-slope":392670,"serialiseData-memory-arguments-intercept":0,"serialiseData-memory-arguments-slope":2,"sha2_256-cpu-arguments-intercept":806990,"sha2_256-cpu-arguments-slope":30482,"sha2_256-memory-arguments":4,"sha3_256-cpu-arguments-intercept":1927926,"sha3_256-cpu-arguments-slope":82523,"sha3_256-memory-arguments":4,"sliceByteString-cpu-arguments-intercept":265318,"sliceByteString-cpu-arguments-slope":0,"sliceByteString-memory-arguments-intercept":4,"sliceByteString-memory-arguments-slope":0,"sndPair-cpu-arguments":85931,"sndPair-memory-arguments":32,"subtractInteger-cpu-arguments-intercept":205665,"subtractInteger-cpu-arguments-slope":812,"subtractInteger-memory-arguments-intercept":1,"subtractInteger-memory-arguments-slope":1,"tailList-cpu-arguments":41182,"tailList-memory-arguments":32,"trace-cpu-arguments":212342,"trace-memory-arguments":32,"unBData-cpu-arguments":31220,"unBData-memory-arguments":32,"unConstrData-cpu-arguments":32696,"unConstrData-memory-arguments":32,"unIData-cpu-arguments":43357,"unIData-memory-arguments":32,"unListData-cpu-arguments":32247,"unListData-memory-arguments":32,"unMapData-cpu-arguments":38314,"unMapData-memory-arguments":32,"verifyEcdsaSecp256k1Signature-cpu-arguments":35892428,"verifyEcdsaSecp256k1Signature-memory-arguments":10,"verifyEd25519Signature-cpu-arguments-intercept":57996947,"verifyEd25519Signature-cpu-arguments-slope":18975,"verifyEd25519Signature-memory-arguments":10,"verifySchnorrSecp256k1Signature-cpu-arguments-intercept":38887044,"verifySchnorrSecp256k1Signature-cpu-arguments-slope":32947,"verifySchnorrSecp256k1Signature-memory-arguments":10}).forEach((s,a)=>t.set(a,n.Int.new_i32(s))),r.insert(n.Language.new_plutus_v1(),e),r.insert(n.Language.new_plutus_v2(),t),r})()},Xe={ALONZO:{V1:"a141005901d59f1a000302590001011a00060bc719026d00011a000249f01903e800011a000249f018201a0025cea81971f70419744d186419744d186419744d186419744d186419744d186419744d18641864186419744d18641a000249f018201a000249f018201a000249f018201a000249f01903e800011a000249f018201a000249f01903e800081a000242201a00067e2318760001011a000249f01903e800081a000249f01a0001b79818f7011a000249f0192710011a0002155e19052e011903e81a000249f01903e8011a000249f018201a000249f018201a000249f0182001011a000249f0011a000249f0041a000194af18f8011a000194af18f8011a0002377c190556011a0002bdea1901f1011a000249f018201a000249f018201a000249f018201a000249f018201a000249f018201a000249f018201a000242201a00067e23187600010119f04c192bd200011a000249f018201a000242201a00067e2318760001011a000242201a00067e2318760001011a0025cea81971f704001a000141bb041a000249f019138800011a000249f018201a000302590001011a000249f018201a000249f018201a000249f018201a000249f018201a000249f018201a000249f018201a000249f018201a00330da70101ff"},BABBAGE:{V1:"a141005901b69f1a0003236119032c01011903e819023b00011903e8195e7104011903e818201a0001ca761928eb041959d818641959d818641959d818641959d818641959d818641959d81864186418641959d81864194c5118201a0002acfa182019b551041a000363151901ff00011a00015c3518201a000797751936f404021a0002ff941a0006ea7818dc0001011903e8196ff604021a0003bd081a00034ec5183e011a00102e0f19312a011a00032e801901a5011a0002da781903e819cf06011a00013a34182019a8f118201903e818201a00013aac0119e143041903e80a1a00030219189c011a00030219189c011a0003207c1901d9011a000330001901ff0119ccf3182019fd40182019ffd5182019581e18201940b318201a00012adf18201a0002ff941a0006ea7818dc0001011a00010f92192da7000119eabb18201a0002ff941a0006ea7818dc0001011a0002ff941a0006ea7818dc0001011a000c504e197712041a001d6af61a0001425b041a00040c660004001a00014fab18201a0003236119032c010119a0de18201a00033d7618201979f41820197fb8182019a95d1820197df718201995aa18201a009063b91903fd0aff",V2:"a20198af1a0003236119032c01011903e819023b00011903e8195e7104011903e818201a0001ca761928eb041959d818641959d818641959d818641959d818641959d818641959d81864186418641959d81864194c5118201a0002acfa182019b551041a000363151901ff00011a00015c3518201a000797751936f404021a0002ff941a0006ea7818dc0001011903e8196ff604021a0003bd081a00034ec5183e011a00102e0f19312a011a00032e801901a5011a0002da781903e819cf06011a00013a34182019a8f118201903e818201a00013aac0119e143041903e80a1a00030219189c011a00030219189c011a0003207c1901d9011a000330001901ff0119ccf3182019fd40182019ffd5182019581e18201940b318201a00012adf18201a0002ff941a0006ea7818dc0001011a00010f92192da7000119eabb18201a0002ff941a0006ea7818dc0001011a0002ff941a0006ea7818dc0001011a0011b22c1a0005fdde00021a000c504e197712041a001d6af61a0001425b041a00040c660004001a00014fab18201a0003236119032c010119a0de18201a00033d7618201979f41820197fb8182019a95d1820197df718201995aa18201b00000004a817c8001b00000004a817c8001a009063b91903fd0a1b00000004a817c800001b00000004a817c80041005901b69f1a0003236119032c01011903e819023b00011903e8195e7104011903e818201a0001ca761928eb041959d818641959d818641959d818641959d818641959d818641959d81864186418641959d81864194c5118201a0002acfa182019b551041a000363151901ff00011a00015c3518201a000797751936f404021a0002ff941a0006ea7818dc0001011903e8196ff604021a0003bd081a00034ec5183e011a00102e0f19312a011a00032e801901a5011a0002da781903e819cf06011a00013a34182019a8f118201903e818201a00013aac0119e143041903e80a1a00030219189c011a00030219189c011a0003207c1901d9011a000330001901ff0119ccf3182019fd40182019ffd5182019581e18201940b318201a00012adf18201a0002ff941a0006ea7818dc0001011a00010f92192da7000119eabb18201a0002ff941a0006ea7818dc0001011a0002ff941a0006ea7818dc0001011a000c504e197712041a001d6af61a0001425b041a00040c660004001a00014fab18201a0003236119032c010119a0de18201a00033d7618201979f41820197fb8182019a95d1820197df718201995aa18201a009063b91903fd0aff"}},Ht={[n.NetworkInfo.testnet().network_id()]:"8d18d786e92776c824607fd8e193ec535c79dc61ea2405ddf3b09fe3",[n.NetworkInfo.mainnet().network_id()]:"f0ff48bbb7bbe9d59a40f1ce90e9e9d0ff5002ec48f232b49ca0fb9a"},Ze={mainnet:"wss://ogmios-api.mainnet.dandelion.link",preprod:"wss://ogmios-api.iohk-preprod.dandelion.link",preview:"__TBD_SOON_TM__",testnet:"wss://ogmios-api.testnet.dandelion.link"},ts={LQ:"da8c30857834c6ae7203935b89278c532b3995245295456f993e1d244c51",MIN:"29d222ce763455e3d7a09a665ce554f00ac89d2e99a1a83d267170c64d494e",NTX:"edfd7a1d77bcb8b884c474bdc92a16002d1fb720e454fa6e993444794e5458",iBTC:"f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b6988069425443",iETH:"f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b6988069455448",iUSD:"f66d78b4a3cb3d37afa0ec36461e51ecbde00f26c8f0a68f94b6988069555344",MILK:"8a1cfae21368b8bebbbed9800fec304e95cce39a2a57dc35e2e3ebaa4d494c4b",AGIX:"f43a62fdc3965df486de8a0d32fe800963589c41b38946602a0dc53541474958",MELD:"6ac8ef33b510ec004fe11585f7c5a9f0c07f0c23428ab4f29c1d7d104d454c44",INDY:"533bb94a8850ee3ccbe483106489399112b74c905342cb1792a797a0494e4459",CLAY:"38ad9dc3aec6a2f38e220142b9aa6ade63ebe71f65e7cc2b7d8a8535434c4159",MCOS:"6f46e1304b16d884c85c62fb0eef35028facdc41aaa0fd319a152ed64d434f53",DING:"ce5b9e0f8a88255b65f2e4d065c6e716e9fa9a8a86dfb86423dd1ac044494e47",GERO:"10a49b996e2402269af553a8a96fb8eb90d79e9eca79e2b4223057b64745524f",NMKR:"5dac8536653edc12f6f5e1045d8164b9f59998d3bdc300fc928434894e4d4b52",PAVIA:"884892bcdc360bcef87d6b3f806e7f9cd5ac30d999d49970e7a903ae5041564941",HOSKY:"a0028f350aaabe0545fdcb56b039bfb08e4bb4d8c4d7c3c7d481c235484f534b59",YUMMI:"078eafce5cd7edafdf63900edef2c1ea759e77f30ca81d6bbdeec92479756d6d69",C3:"8e51398904a5d3fc129fbf4f1589701de23c7824d5c90fdb9490e15a434841524c4933",GIMBAL:"2b0a04a7b60132b1805b296c7fcb3b217ff14413991bf76f72663c3067696d62616c",SUNDAE:"9a9693a9a37912a5097918f97918d15240c92ab729a0b7c4aa144d7753554e444145",GREENS:"4623ab311b7d982d8d26fcbe1a9439ca56661aafcdcd8d8a0ef31fd6475245454e53",GENS:"dda5fdb1002f7389b33e036b6afee82a8189becb6cba852e8b79b4fb0014df1047454e53",SOCIETY:"25f0fc240e91bd95dcdaebd2ba7713fc5168ac77234a3d79449fc20c534f4349455459",DJED:"8db269c3ec630e06ae29f74bc39edd1f87c819f1056206e879a1cd61446a65644d6963726f555344",SHEN:"8db269c3ec630e06ae29f74bc39edd1f87c819f1056206e879a1cd615368656e4d6963726f555344",WMT:"1d7f33bd23d85e1a25d87d86fac4f199c3197a2f7afeb662a0f34e1e776f726c646d6f62696c65746f6b656e",COPI:"b6a7467ea1deb012808ef4e87b5ff371e85f7142d7b356a40d9b42a0436f726e75636f70696173205b76696120436861696e506f72742e696f5d"},jt=["begin","eternl","flint","lace","nami","nufi","gerowallet","typhoncip30","vespr","yoroi"],xe=(r,e,t="5000000")=>{const s=n.BigNum.from_str(r.get("lovelace")??"0").checked_add(n.BigNum.from_str(t)),a=e.filter(c=>c.output.amount.filter(u=>u.unit!=="lovelace").some(u=>r.has(u.unit))),i=as(a);return[...i.less_than(s)?ns(s.clamped_sub(i).to_str(),e.filter(c=>!a.some(u=>u.input.txHash===c.input.txHash&&u.input.outputIndex===c.input.outputIndex))):[],...a]},es=(r,e,t=!1,{maxTxSize:s,minFeeA:a,minFeeB:i}=D)=>{const o=e.filter(l=>we(l)===!1).sort(Ft),c=n.BigNum.from_str(Lt(s,a,i)),u=t?n.BigNum.from_str(r).checked_add(c).to_str():r;return mt(o,new Map([["lovelace",u]]))},Ce=(r,e,t=!1,s=D)=>{const a=e.filter(we).sort(Ft),i=rs(s),o=r.get("lovelace")??"0",c=t?n.BigNum.from_str(o).checked_add(i).to_str():o;return r.set("lovelace",c),mt(a,r)},ss=(r,e)=>Array.from(e,t=>({unit:t[0],quantity:n.BigNum.from_str(t[1])})).every(t=>r.filter(s=>s.output.amount.find(a=>a.unit===t.unit)!==void 0).reduce((s,a)=>{const i=a.output.amount.reduce((o,c)=>o.checked_add(n.BigNum.from_str(t.unit===c.unit?c.quantity:"0")),n.BigNum.from_str("0"));return s.checked_add(i)},n.BigNum.from_str("0")).less_than(t.quantity)===!1),Ft=(r,e)=>{var a,i;const t=n.BigNum.from_str(((a=r.output.amount.find(o=>o.unit==="lovelace"))==null?void 0:a.quantity)??"0");return n.BigNum.from_str(((i=e.output.amount.find(o=>o.unit==="lovelace"))==null?void 0:i.quantity)??"0").compare(t)},rs=r=>{const{maxTxSize:e,minFeeA:t,minFeeB:s}=r;return n.BigNum.from_str(Lt(e,t,s))},we=r=>r.output.amount.length>1,as=r=>r.reduce((e,t)=>{var a;const s=((a=t.output.amount.find(i=>i.unit==="lovelace"))==null?void 0:a.quantity)??"0";return e.checked_add(n.BigNum.from_str(s))},n.BigNum.from_str("0")),ns=(r,e)=>{const t=e.sort(Ft);return mt(t,new Map([["lovelace",r]]))},mt=(r,e,t=[])=>r.length===0||ss(t,e)?t:is(r[0],e)?mt(r.slice(1),e,[...t,r[0]]):mt(r.slice(1),e,t),is=(r,e)=>Array.from(e.keys()).some(t=>r.output.amount.find(s=>s.unit===t)!==void 0),os=(r,e)=>{const t=ds(e),s=hs(r,e);return{coseKey:v(t.to_bytes()),coseSign1:v(s.to_bytes())}},cs=(r,e,{key:t,signature:s})=>{var o,c;const a=_.COSEKey.from_bytes(p(t)),i=_.COSESign1.from_bytes(p(s));if((r==null?void 0:r.length)>0){const u=v(i.payload()??new Uint8Array);if(b(r)!==u)return!1}if((e==null?void 0:e.length)>0){const d=(o=i.headers().protected().deserialized_headers().header(_.Label.new_text("address")))==null?void 0:o.as_bytes();if(d===void 0)throw new Error("Couldn't find a signer address in signature");const g=(c=a.header(_.Label.new_int(_.Int.new_negative(_.BigNum.from_str("2")))))==null?void 0:c.as_bytes();if(g===void 0)throw new Error("Couldn't find a signer key in signature");const l=at(v(d)),A=Ms(v(g));if(us(e,l,A)===!1)throw new Error("Couldn't check signature because of address mismatch");const I=Ks(v(i.signature())),x=i.signed_data().to_bytes();return A.verify(x,I)}return!1},us=(r,e,t)=>{if(r!==e.to_bech32())return!1;try{return it(r)===t.hash().to_hex()}catch{return!1}},ds=r=>{const e=_.COSEKey.new(_.Label.from_key_type(_.KeyType.OKP));return e.set_algorithm_id(_.Label.from_algorithm_id(_.AlgorithmId.EdDSA)),e.set_header(_.Label.new_int(_.Int.new_negative(_.BigNum.from_str("1"))),_.CBORValue.new_int(_.Int.new_i32(6))),e.set_header(_.Label.new_int(_.Int.new_negative(_.BigNum.from_str("2"))),_.CBORValue.new_bytes(r.key.to_public().as_bytes())),e},hs=(r,e)=>{const t=_.HeaderMap.new(),s=_.HeaderMap.new();t.set_algorithm_id(_.Label.from_algorithm_id(_.AlgorithmId.EdDSA)),t.set_header(_.Label.new_text("address"),_.CBORValue.new_bytes(e.address.to_bytes()));const a=_.Headers.new(_.ProtectedHeaderMap.new(t),s),i=_.COSESign1Builder.new(a,p(r.payload),!1);r.externalAAD!==void 0&&i.set_external_aad(p(r.externalAAD));const o=i.make_data_to_sign(),c=e.key.sign(o.to_bytes());return i.build(c.to_bytes())};var Xt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Be={},Q={exports:{}};$.notEqual=gs;$.notOk=As;$.equal=ls;$.ok=$;var Se=$;function ls(r,e,t){$(r==e,t)}function gs(r,e,t){$(r!=e,t)}function As(r,e){$(!r,e)}function $(r,e){if(!r)throw new Error(e||"AssertionError")}var V={exports:{}};function ms(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Is=Ot;Ot.supported=typeof WebAssembly<"u";function Ot(r){if(!Ot.supported)return null;var e=r&&r.imports,t=ps("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMK00AElgMAIABCADcDACAAQQhqQgA3AwAgAEEQakIANwMAIABBGGpCADcDACAAQSBqQgA3AwAgAEEoakIANwMAIABBMGpCADcDACAAQThqQgA3AwAgAEHAAGpCADcDACAAQcgAakIANwMAIABB0ABqQgA3AwAgAEHYAGpCADcDACAAQeAAakIANwMAIABB6ABqQgA3AwAgAEHwAGpCADcDACAAQfgAakIANwMAIABBgAFqQoiS853/zPmE6gBBACkDAIU3AwAgAEGIAWpCu86qptjQ67O7f0EIKQMAhTcDACAAQZABakKr8NP0r+68tzxBECkDAIU3AwAgAEGYAWpC8e30+KWn/aelf0EYKQMAhTcDACAAQaABakLRhZrv+s+Uh9EAQSApAwCFNwMAIABBqAFqQp/Y+dnCkdqCm39BKCkDAIU3AwAgAEGwAWpC6/qG2r+19sEfQTApAwCFNwMAIABBuAFqQvnC+JuRo7Pw2wBBOCkDAIU3AwAgAEHAAWpCADcDACAAQcgBakIANwMAIABB0AFqQgA3AwALbQEDfyAAQcABaiEDIABByAFqIQQgBCkDAKchBQJAA0AgASACRg0BIAVBgAFGBEAgAyADKQMAIAWtfDcDAEEAIQUgABADCyAAIAVqIAEtAAA6AAAgBUEBaiEFIAFBAWohAQwACwsgBCAFrTcDAAtkAQN/IABBwAFqIQEgAEHIAWohAiABIAEpAwAgAikDAHw3AwAgAEHQAWpCfzcDACACKQMApyEDAkADQCADQYABRg0BIAAgA2pBADoAACADQQFqIQMMAAsLIAIgA603AwAgABADC+U7AiB+CX8gAEGAAWohISAAQYgBaiEiIABBkAFqISMgAEGYAWohJCAAQaABaiElIABBqAFqISYgAEGwAWohJyAAQbgBaiEoICEpAwAhASAiKQMAIQIgIykDACEDICQpAwAhBCAlKQMAIQUgJikDACEGICcpAwAhByAoKQMAIQhCiJLznf/M+YTqACEJQrvOqqbY0Ouzu38hCkKr8NP0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"),s=null,a={buffer:t,memory:null,exports:null,realloc:i,onload:o};return o(function(){}),a;function i(u){a.exports.memory.grow(Math.ceil(Math.abs(u-a.memory.length)/65536)),a.memory=new Uint8Array(a.exports.memory.buffer)}function o(u){if(a.exports)return u();if(s){s.then(u.bind(null,null)).catch(u);return}try{if(r&&r.async)throw new Error("async");c({instance:new WebAssembly.Instance(new WebAssembly.Module(t),e)})}catch{s=WebAssembly.instantiate(t,e).then(c)}o(u)}function c(u){a.exports=u.instance.exports,a.memory=a.exports.memory&&a.exports.memory.buffer&&new Uint8Array(a.exports.memory.buffer)}}function ps(r){return typeof atob=="function"?new Uint8Array(atob(r).split("").map(fs)):new(ms("buffer")).Buffer(r,"base64")}function fs(r){return r.charCodeAt(0)}var M=Se,y=Is(),L=64,wt=[];V.exports=k;var Zt=V.exports.BYTES_MIN=16,te=V.exports.BYTES_MAX=64;V.exports.BYTES=32;var ee=V.exports.KEYBYTES_MIN=16,se=V.exports.KEYBYTES_MAX=64;V.exports.KEYBYTES=32;var re=V.exports.SALTBYTES=16,ae=V.exports.PERSONALBYTES=16;function k(r,e,t,s,a){if(!(this instanceof k))return new k(r,e,t,s,a);if(!(y&&y.exports))throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");r||(r=32),a!==!0&&(M(r>=Zt,"digestLength must be at least "+Zt+", was given "+r),M(r<=te,"digestLength must be at most "+te+", was given "+r),e!=null&&M(e.length>=ee,"key must be at least "+ee+", was given "+e.length),e!=null&&M(e.length<=se,"key must be at least "+se+", was given "+e.length),t!=null&&M(t.length===re,"salt must be exactly "+re+", was given "+t.length),s!=null&&M(s.length===ae,"personal must be exactly "+ae+", was given "+s.length)),wt.length||(wt.push(L),L+=216),this.digestLength=r,this.finalized=!1,this.pointer=wt.pop(),y.memory.fill(0,0,64),y.memory[0]=this.digestLength,y.memory[1]=e?e.length:0,y.memory[2]=1,y.memory[3]=1,t&&y.memory.set(t,32),s&&y.memory.set(s,48),this.pointer+216>y.memory.length&&y.realloc(this.pointer+216),y.exports.blake2b_init(this.pointer,this.digestLength),e&&(this.update(e),y.memory.fill(0,L,L+e.length),y.memory[this.pointer+200]=128)}k.prototype.update=function(r){return M(this.finalized===!1,"Hash instance finalized"),M(r,"input must be TypedArray or Buffer"),L+r.length>y.memory.length&&y.realloc(L+r.length),y.memory.set(r,L),y.exports.blake2b_update(this.pointer,L,L+r.length),this};k.prototype.digest=function(r){if(M(this.finalized===!1,"Hash instance finalized"),this.finalized=!0,wt.push(this.pointer),y.exports.blake2b_final(this.pointer),!r||r==="binary")return y.memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if(r==="hex")return ys(y.memory,this.pointer+128,this.digestLength);M(r.length>=this.digestLength,"input must be TypedArray or Buffer");for(var e=0;e<this.digestLength;e++)r[e]=y.memory[this.pointer+128+e];return r};k.prototype.final=k.prototype.digest;k.WASM=y&&y.buffer;k.SUPPORTED=typeof WebAssembly<"u";k.ready=function(r){if(r||(r=_s),!y)return r(new Error("WebAssembly not supported"));var e=new Promise(function(t,s){y.onload(function(a){a?s():t(),r(a)})});return e};k.prototype.ready=k.ready;function _s(){}function ys(r,e,t){for(var s="",a=0;a<t;a++)s+=xs(r[e+a]);return s}function xs(r){return r<16?"0"+r.toString(16):r.toString(16)}var X=Se,It=V.exports;function _t(r,e,t){var s=r[e]+r[t],a=r[e+1]+r[t+1];s>=4294967296&&a++,r[e]=s,r[e+1]=a}function ne(r,e,t,s){var a=r[e]+t;t<0&&(a+=4294967296);var i=r[e+1]+s;a>=4294967296&&i++,r[e]=a,r[e+1]=i}function Ee(r,e){return r[e]^r[e+1]<<8^r[e+2]<<16^r[e+3]<<24}function J(r,e,t,s,a,i){var o=gt[a],c=gt[a+1],u=gt[i],d=gt[i+1];_t(m,r,e),ne(m,r,o,c);var g=m[s]^m[r],l=m[s+1]^m[r+1];m[s]=l,m[s+1]=g,_t(m,t,s),g=m[e]^m[t],l=m[e+1]^m[t+1],m[e]=g>>>24^l<<8,m[e+1]=l>>>24^g<<8,_t(m,r,e),ne(m,r,u,d),g=m[s]^m[r],l=m[s+1]^m[r+1],m[s]=g>>>16^l<<16,m[s+1]=l>>>16^g<<16,_t(m,t,s),g=m[e]^m[t],l=m[e+1]^m[t+1],m[e]=l>>>31^g<<1,m[e+1]=g>>>31^l<<1}var be=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Cs=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],S=new Uint8Array(Cs.map(function(r){return r*2})),m=new Uint32Array(32),gt=new Uint32Array(32);function Qe(r,e){var t=0;for(t=0;t<16;t++)m[t]=r.h[t],m[t+16]=be[t];for(m[24]=m[24]^r.t,m[25]=m[25]^r.t/4294967296,e&&(m[28]=~m[28],m[29]=~m[29]),t=0;t<32;t++)gt[t]=Ee(r.b,4*t);for(t=0;t<12;t++)J(0,8,16,24,S[t*16+0],S[t*16+1]),J(2,10,18,26,S[t*16+2],S[t*16+3]),J(4,12,20,28,S[t*16+4],S[t*16+5]),J(6,14,22,30,S[t*16+6],S[t*16+7]),J(0,10,20,30,S[t*16+8],S[t*16+9]),J(2,12,22,24,S[t*16+10],S[t*16+11]),J(4,14,16,26,S[t*16+12],S[t*16+13]),J(6,8,18,28,S[t*16+14],S[t*16+15]);for(t=0;t<16;t++)r.h[t]=r.h[t]^m[t]^m[t+16]}var j=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function ct(r,e,t,s){j.fill(0),this.b=new Uint8Array(128),this.h=new Uint32Array(16),this.t=0,this.c=0,this.outlen=r,j[0]=r,e&&(j[1]=e.length),j[2]=1,j[3]=1,t&&j.set(t,32),s&&j.set(s,48);for(var a=0;a<16;a++)this.h[a]=be[a]^Ee(j,a*4);e&&(ve(this,e),this.c=128)}ct.prototype.update=function(r){return X(r!=null,"input must be Uint8Array or Buffer"),ve(this,r),this};ct.prototype.digest=function(r){var e=!r||r==="binary"||r==="hex"?new Uint8Array(this.outlen):r;return X(e.length>=this.outlen,"out must have at least outlen bytes of space"),ws(this,e),r==="hex"?Bs(e):e};ct.prototype.final=ct.prototype.digest;ct.ready=function(r){It.ready(function(){r()})};function ve(r,e){for(var t=0;t<e.length;t++)r.c===128&&(r.t+=r.c,Qe(r,!1),r.c=0),r.b[r.c++]=e[t]}function ws(r,e){for(r.t+=r.c;r.c<128;)r.b[r.c++]=0;Qe(r,!0);for(var t=0;t<r.outlen;t++)e[t]=r.h[t>>2]>>8*(t&3);return e}function Bs(r){for(var e="",t=0;t<r.length;t++)e+=Ss(r[t]);return e}function Ss(r){return r<16?"0"+r.toString(16):r.toString(16)}var De=ct;Q.exports=function(e,t,s,a,i){return i!==!0&&(X(e>=ie,"outlen must be at least "+ie+", was given "+e),X(e<=oe,"outlen must be at most "+oe+", was given "+e),t!=null&&X(t.length>=ce,"key must be at least "+ce+", was given "+t.length),t!=null&&X(t.length<=ue,"key must be at most "+ue+", was given "+t.length),s!=null&&X(s.length===de,"salt must be exactly "+de+", was given "+s.length),a!=null&&X(a.length===he,"personal must be exactly "+he+", was given "+a.length)),new De(e,t,s,a)};Q.exports.ready=function(r){It.ready(function(){r()})};Q.exports.WASM_SUPPORTED=It.SUPPORTED;Q.exports.WASM_LOADED=!1;var ie=Q.exports.BYTES_MIN=16,oe=Q.exports.BYTES_MAX=64;Q.exports.BYTES=32;var ce=Q.exports.KEYBYTES_MIN=16,ue=Q.exports.KEYBYTES_MAX=64;Q.exports.KEYBYTES=32;var de=Q.exports.SALTBYTES=16,he=Q.exports.PERSONALBYTES=16;It.ready(function(r){r||(Q.exports.WASM_LOADED=!0,De=It)});var ut={};Object.defineProperty(ut,"__esModule",{value:!0});ut.bech32m=ut.bech32=void 0;const bt="qpzry9x8gf2tvdw0s3jn54khce6mua7l",ke={};for(let r=0;r<bt.length;r++){const e=bt.charAt(r);ke[e]=r}function ot(r){const e=r>>25;return(r&33554431)<<5^-(e>>0&1)&996825010^-(e>>1&1)&642813549^-(e>>2&1)&513874426^-(e>>3&1)&1027748829^-(e>>4&1)&705979059}function le(r){let e=1;for(let t=0;t<r.length;++t){const s=r.charCodeAt(t);if(s<33||s>126)return"Invalid prefix ("+r+")";e=ot(e)^s>>5}e=ot(e);for(let t=0;t<r.length;++t){const s=r.charCodeAt(t);e=ot(e)^s&31}return e}function Vt(r,e,t,s){let a=0,i=0;const o=(1<<t)-1,c=[];for(let u=0;u<r.length;++u)for(a=a<<e|r[u],i+=e;i>=t;)i-=t,c.push(a>>i&o);if(s)i>0&&c.push(a<<t-i&o);else{if(i>=e)return"Excess padding";if(a<<t-i&o)return"Non-zero padding"}return c}function Es(r){return Vt(r,8,5,!0)}function bs(r){const e=Vt(r,5,8,!1);if(Array.isArray(e))return e}function Qs(r){const e=Vt(r,5,8,!1);if(Array.isArray(e))return e;throw new Error(e)}function Te(r){let e;r==="bech32"?e=1:e=734539939;function t(o,c,u){if(u=u||90,o.length+7+c.length>u)throw new TypeError("Exceeds length limit");o=o.toLowerCase();let d=le(o);if(typeof d=="string")throw new Error(d);let g=o+"1";for(let l=0;l<c.length;++l){const A=c[l];if(A>>5!==0)throw new Error("Non 5-bit word");d=ot(d)^A,g+=bt.charAt(A)}for(let l=0;l<6;++l)d=ot(d);d^=e;for(let l=0;l<6;++l){const A=d>>(5-l)*5&31;g+=bt.charAt(A)}return g}function s(o,c){if(c=c||90,o.length<8)return o+" too short";if(o.length>c)return"Exceeds length limit";const u=o.toLowerCase(),d=o.toUpperCase();if(o!==u&&o!==d)return"Mixed-case string "+o;o=u;const g=o.lastIndexOf("1");if(g===-1)return"No separator character for "+o;if(g===0)return"Missing prefix for "+o;const l=o.slice(0,g),A=o.slice(g+1);if(A.length<6)return"Data too short";let I=le(l);if(typeof I=="string")return I;const x=[];for(let T=0;T<A.length;++T){const W=A.charAt(T),f=ke[W];if(f===void 0)return"Unknown character "+W;I=ot(I)^f,!(T+6>=A.length)&&x.push(f)}return I!==e?"Invalid checksum for "+o:{prefix:l,words:x}}function a(o,c){const u=s(o,c);if(typeof u=="object")return u}function i(o,c){const u=s(o,c);if(typeof u=="object")return u;throw new Error(u)}return{decodeUnsafe:a,decode:i,encode:t,toWords:Es,fromWordsUnsafe:bs,fromWords:Qs}}ut.bech32=Te("bech32");ut.bech32m=Te("bech32m");var vs=Xt&&Xt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Be,"__esModule",{value:!0});const Ds=vs(Q.exports),yt=ut,Pt="asset";class At{constructor(e){this.hashBuf=e}static fromHash(e){return new At(e)}static fromParts(e,t){const s=(0,Ds.default)(20).update(new Uint8Array([...e,...t])).digest("binary");return At.fromHash(s)}static fromBech32(e){const{prefix:t,words:s}=yt.bech32.decode(e);if(t!==Pt)throw new Error("Invalid asset fingerprint");const a=Buffer.from(yt.bech32.fromWords(s));return At.fromHash(a)}fingerprint(){const e=yt.bech32.toWords(this.hashBuf);return yt.bech32.encode(Pt,e)}hash(){return Buffer.from(this.hashBuf).toString("hex")}prefix(){return Pt}checksum(){return this.fingerprint().slice(-6)}}var ks=Be.default=At;const Ts=ks,Us=(r,e)=>{const t=Ps(r),s=t.derive(Ut+1852).derive(Ut+1815).derive(Ut+e),a=s.derive(0).derive(0).to_raw_key(),i=s.derive(2).derive(0).to_raw_key();return s.free(),t.free(),{paymentKey:a,stakeKey:i}},at=r=>n.Address.from_bytes(p(r)),Ps=r=>n.Bip32PrivateKey.from_bytes(p(r)),Ns=r=>n.DataHash.from_bytes(p(r)),F=r=>n.Ed25519KeyHash.from_bytes(p(r)),Ks=r=>n.Ed25519Signature.from_bytes(p(r)),Dt=r=>n.NativeScript.from_bytes(p(r)),Ms=r=>n.PublicKey.from_bytes(p(r)),Ue=r=>n.PlutusData.from_bytes(p(r)),dt=(r,e)=>n.PlutusScript.from_bytes_with_version(p(r),q[e]),Hs=r=>n.ScriptRef.from_bytes(p(r)),Fs=r=>n.ScriptHash.from_bytes(p(r)),Y=r=>n.Transaction.from_bytes(p(r)),Pe=r=>n.TransactionHash.from_bytes(p(r)),ge=r=>n.TransactionUnspentOutput.from_bytes(p(r)),Os=r=>n.TransactionWitnessSet.from_bytes(p(r)),Vs=r=>n.Value.from_bytes(p(r)),K=r=>n.Address.from_bech32(r),Rt=r=>n.BaseAddress.from_address(K(r)),Ne=r=>n.EnterpriseAddress.from_address(K(r)),Ke=r=>n.RewardAddress.from_address(K(r)),v=r=>Buffer.from(r).toString("hex"),p=r=>r.length%2===0&&/^[0-9A-F]*$/i.test(r)?Buffer.from(r,"hex"):Buffer.from(r,"utf-8"),kt=r=>{const e=t=>{const s=new Array;for(let a=0;a<t.len();a+=1)s.push(kt(t.get(a)));return s};switch(r.kind()){case n.NativeScriptKind.ScriptAll:{const t=r.as_script_all();return{type:"all",scripts:e(t.native_scripts())}}case n.NativeScriptKind.ScriptAny:{const t=r.as_script_any();return{type:"any",scripts:e(t.native_scripts())}}case n.NativeScriptKind.ScriptNOfK:{const t=r.as_script_n_of_k();return{type:"atLeast",required:t.n(),scripts:e(t.native_scripts())}}case n.NativeScriptKind.TimelockStart:{const t=r.as_timelock_start();return{type:"after",slot:t.slot_bignum().to_str()}}case n.NativeScriptKind.TimelockExpiry:{const t=r.as_timelock_expiry();return{type:"before",slot:t.slot_bignum().to_str()}}case n.NativeScriptKind.ScriptPubkey:{const t=r.as_script_pubkey();return{type:"sig",keyHash:t.addr_keyhash().to_hex()}}default:throw new Error(`Script Kind: ${r.kind()}, is not supported`)}},Tt=r=>{const e=t=>{const s=n.NativeScripts.new();return t.forEach(a=>{s.add(Tt(a))}),s};switch(r.type){case"all":return n.NativeScript.new_script_all(n.ScriptAll.new(e(r.scripts)));case"any":return n.NativeScript.new_script_any(n.ScriptAny.new(e(r.scripts)));case"atLeast":return n.NativeScript.new_script_n_of_k(n.ScriptNOfK.new(r.required,e(r.scripts)));case"after":return n.NativeScript.new_timelock_start(n.TimelockStart.new_timelockstart(n.BigNum.from_str(r.slot)));case"before":return n.NativeScript.new_timelock_expiry(n.TimelockExpiry.new_timelockexpiry(n.BigNum.from_str(r.slot)));case"sig":return n.NativeScript.new_script_pubkey(n.ScriptPubkey.new(F(r.keyHash)))}},Bt=r=>{var s,a,i;const e=o=>{const c=[];for(let u=0;u<o.len();u+=1)c.push(Bt(o.get(u)));return c},t=o=>{const c=new Map;for(let u=0;u<o.len();u+=1){const d=o.keys().get(u),g=o.get(d)??n.PlutusData.from_hex(b("NO_ITEM_FOUND_INSIDE_GOLD_ROOM"));c.set(Bt(d),Bt(g))}return c};switch(r.kind()){case n.PlutusDataKind.Bytes:return v(r.as_bytes()??new Uint8Array);case n.PlutusDataKind.Integer:return parseInt(((s=r.as_integer())==null?void 0:s.to_str())??"0",10);case n.PlutusDataKind.List:return e(r.as_list()??n.PlutusList.new());case n.PlutusDataKind.Map:return t(r.as_map()??n.PlutusMap.new());case n.PlutusDataKind.ConstrPlutusData:return{alternative:parseInt(((a=r.as_constr_plutus_data())==null?void 0:a.alternative().to_str())??"0",10),fields:e(((i=r.as_constr_plutus_data())==null?void 0:i.data())??n.PlutusList.new())};default:throw new Error(`PlutusData Kind: ${r.kind()}, is not supported`)}},tt=r=>{const e=t=>{const s=n.PlutusList.new();return t.forEach(a=>{s.add(tt(a))}),s};switch(typeof r){case"string":return n.PlutusData.new_bytes(p(r));case"number":return n.PlutusData.new_integer(n.BigInt.from_str(r.toString()));case"object":if(r instanceof Array){const t=e(r);return n.PlutusData.new_list(t)}else if(r instanceof Map){const t=n.PlutusMap.new();return r.forEach((s,a)=>{t.insert(tt(a),tt(s))}),n.PlutusData.new_map(t)}else return n.PlutusData.new_constr_plutus_data(n.ConstrPlutusData.new(n.BigNum.from_str(r.alternative.toString()),e(r.fields)))}},Rs=r=>{const e=n.Relays.new();throw r.relays.forEach(t=>{e.add(qs(t))}),new Error("toPoolParams not implemented.")},Me=r=>{const e=t=>je[t];return n.Redeemer.new(e(r.tag),n.BigNum.from_str(r.index.toString()),tt(r.data),n.ExUnits.new(n.BigNum.from_str(r.budget.mem.toString()),n.BigNum.from_str(r.budget.steps.toString())))},qs=r=>{switch(r.type){case"SingleHostAddr":{const e=r.IPV4?n.Ipv4.new(new Uint8Array(r.IPV4.split(".").map(s=>parseInt(s)))):void 0,t=r.IPV6?n.Ipv6.new(p(r.IPV6.replaceAll(":",""))):void 0;return n.Relay.new_single_host_addr(n.SingleHostAddr.new(r.port,e,t))}case"SingleHostName":return n.Relay.new_single_host_name(n.SingleHostName.new(r.port,n.DNSRecordAorAAAA.new(r.domainName)));case"MultiHostName":return n.Relay.new_multi_host_name(n.MultiHostName.new(n.DNSRecordSRV.new(r.domainName)))}},He=r=>{if(r.is_plutus_script()){const t=r.plutus_script();return{code:t.to_hex(),version:Object.keys(q).find(s=>q[s].to_hex()===t.language_version().to_hex())}}const e=r.native_script();return kt(e)},ht=r=>{if("code"in r){const e=dt(r.code,r.version);return n.ScriptRef.new_plutus_script(e)}return n.ScriptRef.new_native_script(Tt(r))},Qt=r=>{var a,i,o;const e=r.output().has_data_hash()?(a=r.output().data_hash())==null?void 0:a.to_hex():void 0,t=r.output().has_plutus_data()?(i=r.output().plutus_data())==null?void 0:i.to_hex():void 0,s=r.output().has_script_ref()?(o=r.output().script_ref())==null?void 0:o.to_hex():void 0;return{input:{outputIndex:r.input().index(),txHash:r.input().transaction_id().to_hex()},output:{address:r.output().address().to_bech32(),amount:Fe(r.output().amount()),dataHash:e,plutusData:t,scriptRef:s}}},H=r=>{const e=n.TransactionInput.new(Pe(r.input.txHash),r.input.outputIndex),t=n.TransactionOutput.new(K(r.output.address),Z(r.output.amount));return r.output.dataHash!==void 0&&t.set_data_hash(Ns(r.output.dataHash)),r.output.plutusData!==void 0&&t.set_plutus_data(Ue(r.output.plutusData)),r.output.scriptRef!==void 0&&t.set_script_ref(Hs(r.output.scriptRef)),n.TransactionUnspentOutput.new(e,t)},Ae=r=>{const e=r.split(".")[1]??"0",t=`${parseInt(e,10)}`,s="1"+"0".repeat(e.length);return n.UnitInterval.new(n.BigNum.from_str(t),n.BigNum.from_str(s))},b=r=>r.length%2===0&&/^[0-9A-F]*$/i.test(r)?r:v(Buffer.from(r,"utf-8")),qt=r=>Buffer.from(r,"hex").toString("utf-8"),Fe=r=>{const e=[{unit:"lovelace",quantity:r.coin().to_str()}],t=r.multiasset();if(t!==void 0){const s=t.keys();for(let a=0;a<s.len();a+=1){const i=s.get(a),o=t.get(i);if(o!==void 0){const c=o.keys();for(let u=0;u<c.len();u+=1){const d=c.get(u),g=o.get(d)??n.BigNum.from_str("0"),l=i.to_hex()+v(d.name());e.push({unit:l,quantity:g.to_str()})}}}}return e},Z=r=>{const e=r.find(i=>i.unit==="lovelace"),t=Array.from(new Set(r.filter(i=>i.unit!=="lovelace").map(i=>i.unit.slice(0,O)))),s=n.MultiAsset.new();t.forEach(i=>{const o=n.Assets.new();r.filter(c=>c.unit.slice(0,O)===i).forEach(c=>{o.insert(n.AssetName.new(p(c.unit.slice(O))),n.BigNum.from_str(c.quantity))}),s.insert(Fs(i),o)});const a=n.Value.new(n.BigNum.from_str(e?e.quantity:"0"));return(r.length>1||!e)&&a.set_multiasset(s),a},me=(r,e,t)=>n.BaseAddress.new(r,n.StakeCredential.from_keyhash(e),n.StakeCredential.from_keyhash(t)),Oe=(r,e="")=>n.Bip32PrivateKey.from_bip39_entropy(p(r),p(b(e))),Kt=r=>n.DataCost.new_coins_per_byte(n.BigNum.from_str(r)),Ls=r=>{if(typeof r!="object"||!("input"in r))return n.DatumSource.new(tt(r));const e=H(r);if(e.output().has_plutus_data())return n.DatumSource.new_ref_input(e.input());throw new Error(`No inline datum found in UTxO: ${e.input().transaction_id().to_hex()}`)},Ie=(r,e)=>n.EnterpriseAddress.new(r,n.StakeCredential.from_keyhash(e)),pe=(r,e)=>{if(typeof r=="string")return n.MintWitness.new_native_script(Dt(r));if(e===void 0)throw new Error("Minting with plutus requires a redeemer to be defined");if(e.tag!=="MINT")throw new Error("Minting redeemer's tag must be defined as 'MINT'");return n.MintWitness.new_plutus_script(Ve(r),Me({tag:"MINT",index:0,budget:nt,data:{alternative:0,fields:[]},...e}))},Mt=(r,e)=>n.RewardAddress.new(r,n.StakeCredential.from_keyhash(e)),Ve=r=>{if("code"in r)return n.PlutusScriptSource.new(dt(r.code,r.version));const e=H(r);if(e.output().has_script_ref()){const t=e.output().script_ref();if(t.is_plutus_script()){const s=He(t),a=dt(s.code,s.version).hash();return n.PlutusScriptSource.new_ref_input_with_lang_ver(a,e.input(),q[s.version])}}throw new Error(`No plutus script reference found in UTxO: ${e.input().transaction_id().to_hex()}`)},xt=r=>{const e=n.ScriptPubkey.new(r);return n.NativeScript.new_script_pubkey(e)},St=(r=D)=>{const e=n.TransactionBuilderConfigBuilder.new().coins_per_utxo_byte(n.BigNum.from_str(r.coinsPerUTxOSize)).ex_unit_prices(n.ExUnitPrices.new(Ae(r.priceMem.toString()),Ae(r.priceStep.toString()))).fee_algo(n.LinearFee.new(n.BigNum.from_str(r.minFeeA.toString()),n.BigNum.from_str(r.minFeeB.toString()))).key_deposit(n.BigNum.from_str(r.keyDeposit)).max_tx_size(r.maxTxSize).max_value_size(parseInt(r.maxValSize,10)).pool_deposit(n.BigNum.from_str(r.poolDeposit)).build();return n.TransactionBuilder.new(e)},fe=r=>{const e=n.TxInputsBuilder.new();return r.map(t=>t instanceof n.TransactionUnspentOutput?t:H(t)).forEach(t=>{e.add_input(t.output().address(),t.input(),t.output().amount())}),e},Ct=r=>{if(typeof r=="string")return n.TransactionOutputBuilder.new().with_address(K(r));let e=n.TransactionOutputBuilder.new().with_address(K(r.address));if(r.datum){const{value:t,inline:s}=r.datum,a=tt(t);e=e.with_data_hash(n.hash_plutus_data(a)),s&&(e=e.with_plutus_data(a))}if(r.script){const t=ht(r.script);e=e.with_script_ref(t)}return e},z=r=>{const e=r.slice(0,O),t=r.includes(".")?b(r.split(".")[1]):r.slice(O);return{policyId:e,assetName:t}},h=r=>G.default.isAxiosError(r)?r.response?JSON.stringify({data:r.response.data,headers:r.response.headers,status:r.response.status}):r.request?JSON.stringify(r.request):r.message:JSON.stringify(r),Ys=r=>{const e=tt(r);return n.hash_plutus_data(e).to_hex()},Gs=(r,e=Date.now())=>{if(Et[r]){const[t,s,a,i]=Et[r];return parseInt(n.BigNum.from_str(e.toString()).div_floor(n.BigNum.from_str("1000")).checked_sub(n.BigNum.from_str(a)).div_floor(n.BigNum.from_str(i)).checked_add(n.BigNum.from_str(t)).to_str(),10)}throw new Error(`Couldn't resolve EpochNo for network: ${r}`)},Re=(r,e)=>Ts.fromParts(p(r),p(e)).fingerprint(),$s=(r,e)=>Xe[r][e],zs=r=>Tt(r).hash().to_hex(),st=r=>{var e,t;try{const s=[(e=Rt(r))==null?void 0:e.payment_cred().to_keyhash(),(t=Ne(r))==null?void 0:t.payment_cred().to_keyhash()].find(a=>a!==void 0);if(s!==void 0)return s.to_hex();throw new Error(`Couldn't resolve payment key hash from address: ${r}`)}catch(s){throw new Error(`An error occurred during resolvePaymentKeyHash: ${s}.`)}},Ws=(r,e=0)=>{const t=dt(r.code,r.version);return n.EnterpriseAddress.new(e,n.StakeCredential.from_scripthash(t.hash())).to_address().to_bech32()},Js=r=>{try{const e=Ne(r),t=e==null?void 0:e.payment_cred().to_scripthash();if(t!==void 0)return t.to_hex();throw new Error(`Couldn't resolve script hash from address: ${r}`)}catch(e){throw new Error(`An error occurred during resolveScriptHash: ${e}.`)}},js=r=>n.Ed25519KeyHash.from_hex(r).to_bech32("pool1"),Xs=r=>{const e=Nt.mnemonicToEntropy(r.join(" ")),t=Oe(e),s=t.to_bech32();return t.free(),s},Zs=r=>ht(r).to_hex(),tr=(r,e=Date.now())=>{if(Et[r]){const[t,s,a]=Et[r];return n.BigNum.from_str(e.toString()).div_floor(n.BigNum.from_str("1000")).checked_sub(n.BigNum.from_str(a)).checked_add(n.BigNum.from_str(s)).to_str()}throw new Error(`Couldn't resolve SlotNo for network: ${r}`)},pt=r=>{try{const e=K(r),t=Rt(r),s=t==null?void 0:t.stake_cred().to_keyhash();if(s!==void 0)return Mt(e.network_id(),s).to_address().to_bech32();throw new Error(`Couldn't resolve reward address from address: ${r}`)}catch(e){throw new Error(`An error occurred during resolveRewardAddress: ${e}.`)}},it=r=>{var e,t;try{const s=[(e=Rt(r))==null?void 0:e.stake_cred().to_keyhash(),(t=Ke(r))==null?void 0:t.payment_cred().to_keyhash()].find(a=>a!==void 0);if(s!==void 0)return s.to_hex();throw new Error(`Couldn't resolve stake key hash from address: ${r}`)}catch(s){throw new Error(`An error occurred during resolveStakeKeyHash: ${s}.`)}},Lt=(r,e=D.minFeeA,t=D.minFeeB)=>(BigInt(e)*BigInt(r)+BigInt(t)).toString(),qe=r=>{const e=Y(r).body();return n.hash_transaction(e).to_hex()},er=(r="",e=32)=>{if(e<=0||e>2048)throw new Error("Length must be bewteen 1 and 2048");const s=_e.customAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")(e);return b(`${r}${s}`)},Le=(r,e)=>{const t=r.vkeys();if(t!==void 0){const s=new Set;for(let i=0;i<t.len();i+=1)s.add(t.get(i).to_hex());for(let i=0;i<e.len();i+=1)s.add(e.get(i).to_hex());const a=n.Vkeywitnesses.new();return s.forEach(i=>{a.add(n.Vkeywitness.from_hex(i))}),a}return e},sr=r=>Bt(Ue(r)),rr=r=>Y(r).to_js_value();class ar{_axiosInstance;constructor(...e){if(typeof e[0]=="string"&&e[0].startsWith("http"))this._axiosInstance=G.default.create({baseURL:e[0]});else{const t=e[0],s=t.slice(0,7);this._axiosInstance=G.default.create({baseURL:`https://cardano-${s}.blockfrost.io/api/v${e[1]??0}`,headers:{project_id:t}})}}async fetchAccountInfo(e){const t=e.startsWith("addr")?pt(e):e;try{const{data:s,status:a}=await this._axiosInstance.get(`accounts/${t}`);if(a===200)return{poolId:s.pool_id,active:s.active||s.active_epoch!==null,balance:s.controlled_amount,rewards:s.withdrawable_amount,withdrawals:s.withdrawals_sum};throw h(s)}catch(s){throw h(s)}}resolveScriptRef=async e=>{if(e){const{data:t,status:s}=await this._axiosInstance.get(`scripts/${e}`);if(s===200){const a=t.type.startsWith("plutus")?{code:await this.fetchPlutusScriptCBOR(e),version:t.type.replace("plutus","")}:await this.fetchNativeScriptJSON(e);return ht(a).to_hex()}throw h(t)}};toUTxO=async(e,t)=>({input:{outputIndex:e.output_index,txHash:t},output:{address:e.address,amount:e.amount,dataHash:e.data_hash??void 0,plutusData:e.inline_datum??void 0,scriptRef:await this.resolveScriptRef(e.reference_script_hash),scriptHash:e.reference_script_hash}});async fetchAddressUTxOs(e,t){const s=t!==void 0?`/${t}`:"",a=`addresses/${e}/utxos`+s,i=async(o=1,c=[])=>{const{data:u,status:d}=await this._axiosInstance.get(`${a}?page=${o}`);if(d===200)return u.length>0?i(o+1,[...c,...await Promise.all(u.map(g=>this.toUTxO(g,g.tx_hash)))]):c;throw h(u)};try{return await i()}catch{return[]}}async fetchAssetAddresses(e){const t=async(s=1,a=[])=>{const{policyId:i,assetName:o}=z(e),{data:c,status:u}=await this._axiosInstance.get(`assets/${i}${o}/addresses?page=${s}`);if(u===200)return c.length>0?t(s+1,[...a,...c]):a;throw h(c)};try{return await t()}catch{return[]}}async fetchAssetMetadata(e){try{const{policyId:t,assetName:s}=z(e),{data:a,status:i}=await this._axiosInstance.get(`assets/${t}${s}`);if(i===200)return{...a.onchain_metadata};throw h(a)}catch(t){throw h(t)}}async fetchBlockInfo(e){try{const{data:t,status:s}=await this._axiosInstance.get(`blocks/${e}`);if(s===200)return{confirmations:t.confirmations,epoch:t.epoch,epochSlot:t.epoch_slot.toString(),fees:t.fees,hash:t.hash,nextBlock:t.next_block??"",operationalCertificate:t.op_cert,output:t.output??"0",previousBlock:t.previous_block,size:t.size,slot:t.slot.toString(),slotLeader:t.slot_leader??"",time:t.time,txCount:t.tx_count,VRFKey:t.block_vrf};throw h(t)}catch(t){throw h(t)}}async fetchCollectionAssets(e,t=1){try{const{data:s,status:a}=await this._axiosInstance.get(`assets/policy/${e}?page=${t}`);if(a===200)return{assets:s.map(i=>({unit:i.asset,quantity:i.quantity})),next:s.length===100?t+1:null};throw h(s)}catch{return{assets:[],next:null}}}async fetchHandleAddress(e){try{const t=b(e.replace("$","")),{data:s,status:a}=await this._axiosInstance.get(`assets/${Ht[1]}${t}/addresses`);if(a===200)return s[0].address;throw h(s)}catch(t){throw h(t)}}async fetchProtocolParameters(e=Number.NaN){try{const{data:t,status:s}=await this._axiosInstance.get(`epochs/${isNaN(e)?"latest":e}/parameters`);if(s===200)return{coinsPerUTxOSize:t.coins_per_utxo_word,collateralPercent:t.collateral_percent,decentralisation:t.decentralisation_param,epoch:t.epoch,keyDeposit:t.key_deposit,maxBlockExMem:t.max_block_ex_mem,maxBlockExSteps:t.max_block_ex_steps,maxBlockHeaderSize:t.max_block_header_size,maxBlockSize:t.max_block_size,maxCollateralInputs:t.max_collateral_inputs,maxTxExMem:t.max_tx_ex_mem,maxTxExSteps:t.max_tx_ex_steps,maxTxSize:t.max_tx_size,maxValSize:t.max_val_size,minFeeA:t.min_fee_a,minFeeB:t.min_fee_b,minPoolCost:t.min_pool_cost,poolDeposit:t.pool_deposit,priceMem:t.price_mem,priceStep:t.price_step};throw h(t)}catch(t){throw h(t)}}async fetchTxInfo(e){try{const{data:t,status:s}=await this._axiosInstance.get(`txs/${e}`);if(s===200)return{block:t.block,deposit:t.deposit,fees:t.fees,hash:t.hash,index:t.index,invalidAfter:t.invalid_hereafter??"",invalidBefore:t.invalid_before??"",slot:t.slot.toString(),size:t.size};throw h(t)}catch(t){throw h(t)}}async fetchUTxOs(e){try{const{data:t,status:s}=await this._axiosInstance.get(`txs/${e}/utxos`);if(s===200){const a=t.outputs,i=[];return a.forEach(c=>{i.push(this.toUTxO(c,e))}),await Promise.all(i)}throw h(t)}catch(t){throw h(t)}}onTxConfirmed(e,t,s=100){let a=0;const i=setInterval(()=>{a>=s&&clearInterval(i),this.fetchTxInfo(e).then(o=>{this.fetchBlockInfo(o.block).then(c=>{(c==null?void 0:c.confirmations)>0&&(clearInterval(i),t())}).catch(()=>{a+=1})}).catch(()=>{a+=1})},5e3)}async submitTx(e){try{const t={"Content-Type":"application/cbor"},{data:s,status:a}=await this._axiosInstance.post("tx/submit",p(e),{headers:t});if(a===200)return s;throw h(s)}catch(t){throw h(t)}}async fetchPlutusScriptCBOR(e){const{data:t,status:s}=await this._axiosInstance.get(`scripts/${e}/cbor`);if(s===200)return t.cbor;throw h(t)}async fetchNativeScriptJSON(e){const{data:t,status:s}=await this._axiosInstance.get(`scripts/${e}/json`);if(s===200)return t.json;throw h(t)}}class nr{_axiosInstance;constructor(e,t,s){const a=s.host??"ipfs.infura.io",i=s.port??5001,o=s.version??0;this._axiosInstance=G.default.create({baseURL:`https://${a}:${i}/api/v${o}`,auth:{username:e,password:t}})}async uploadContent(e,t=!1){try{const s={"Content-Type":"multipart/form-data"},{data:a,status:i}=await this._axiosInstance.post(`add?recursive=${t}`,e,{headers:s});if(i===200)return a;throw h(a)}catch(s){throw h(s)}}}class ir{_axiosInstance;constructor(...e){typeof e[0]=="string"&&e[0].startsWith("http")?this._axiosInstance=G.default.create({baseURL:e[0],headers:{Authorization:`Bearer ${e[1]}`}}):this._axiosInstance=G.default.create({baseURL:`https://${e[0]}.koios.rest/api/v${e[2]??0}`,headers:{Authorization:`Bearer ${e[1]}`}})}async fetchAccountInfo(e){try{const t=e.startsWith("addr")?pt(e):e,{data:s,status:a}=await this._axiosInstance.post("account_info",{_stake_addresses:[t]});if(a===200)return{poolId:s[0].delegated_pool,active:s[0].status==="registered",balance:s[0].total_balance.toString(),rewards:s[0].rewards_available,withdrawals:s[0].withdrawals};throw h(s)}catch(t){throw h(t)}}async fetchAddressUTxOs(e,t){try{const{data:s,status:a}=await this._axiosInstance.post("address_info",{_addresses:[e]});if(a===200){const i=s.flatMap(o=>o.utxo_set).map(o=>this.toUTxO(o,e));return t!==void 0?i.filter(o=>o.output.amount.find(c=>c.unit===t)!==void 0):i}throw h(s)}catch{return[]}}async fetchAssetAddresses(e){try{const{policyId:t,assetName:s}=z(e),{data:a,status:i}=await this._axiosInstance.get(`asset_address_list?_asset_policy=${t}&_asset_name=${s}`);if(i===200)return a.map(o=>({address:o.payment_address,quantity:o.quantity}));throw h(a)}catch(t){throw h(t)}}async fetchAssetMetadata(e){try{const{policyId:t,assetName:s}=z(e),{data:a,status:i}=await this._axiosInstance.get(`asset_info?_asset_policy=${t}&_asset_name=${s}`);if(i===200)return{...a[0].minting_tx_metadata[721][t][qt(s)]};throw h(a)}catch(t){throw h(t)}}async fetchBlockInfo(e){try{const{data:t,status:s}=await this._axiosInstance.post("block_info",{_block_hashes:[e]});if(s===200)return{confirmations:t[0].num_confirmations,epoch:t[0].epoch_no,epochSlot:t[0].epoch_slot.toString(),fees:t[0].total_fees??"",hash:t[0].hash,nextBlock:t[0].child_hash??"",operationalCertificate:t[0].op_cert,output:t[0].total_output??"0",previousBlock:t[0].parent_hash,size:t[0].block_size,slot:t[0].abs_slot.toString(),slotLeader:t[0].pool??"",time:t[0].block_time,txCount:t[0].tx_count,VRFKey:t[0].vrf_key};throw h(t)}catch(t){throw h(t)}}async fetchCollectionAssets(e,t=0){try{const{data:s,status:a}=await this._axiosInstance.get(`asset_policy_info?_asset_policy=${e}&limit=100&offset=${t}`);if(a===200)return{assets:s.map(i=>({unit:`${e}${i.asset_name}`,quantity:i.total_supply})),next:s.length===100?t+100:null};throw h(s)}catch(s){throw h(s)}}async fetchHandleAddress(e){try{const t=b(e.replace("$","")),{data:s,status:a}=await this._axiosInstance.get(`asset_address_list?_asset_policy=${Ht[1]}&_asset_name=${t}`);if(a===200)return s[0].payment_address;throw h(s)}catch(t){throw h(t)}}async fetchProtocolParameters(e){try{const{data:t,status:s}=await this._axiosInstance.get(`epoch_params?_epoch_no=${e}`);if(s===200)return{coinsPerUTxOSize:t[0].coins_per_utxo_size,collateralPercent:t[0].collateral_percent,decentralisation:t[0].decentralisation,epoch:t[0].epoch_no,keyDeposit:t[0].key_deposit,maxBlockExMem:t[0].max_block_ex_mem.toString(),maxBlockExSteps:t[0].max_block_ex_steps.toString(),maxBlockHeaderSize:t[0].max_bh_size,maxBlockSize:t[0].max_block_size,maxCollateralInputs:t[0].max_collateral_inputs,maxTxExMem:t[0].max_tx_ex_mem.toString(),maxTxExSteps:t[0].max_tx_ex_steps.toString(),maxTxSize:t[0].max_tx_size,maxValSize:t[0].max_val_size.toString(),minFeeA:t[0].min_fee_a,minFeeB:t[0].min_fee_b,minPoolCost:t[0].min_pool_cost,poolDeposit:t[0].pool_deposit,priceMem:t[0].price_mem,priceStep:t[0].price_step};throw h(t)}catch(t){throw h(t)}}async fetchTxInfo(e){var t,s;try{const{data:a,status:i}=await this._axiosInstance.post("tx_info",{_tx_hashes:[e]});if(i===200)return{block:a[0].block_hash,deposit:a[0].deposit,fees:a[0].fee,hash:a[0].tx_hash,index:a[0].tx_block_index,invalidAfter:((t=a[0].invalid_after)==null?void 0:t.toString())??"",invalidBefore:((s=a[0].invalid_before)==null?void 0:s.toString())??"",slot:a[0].absolute_slot.toString(),size:a[0].tx_size};throw h(a)}catch(a){throw h(a)}}async fetchUTxOs(e){try{console.log("hi");const{data:t,status:s}=await this._axiosInstance.post("tx_info",{_tx_hashes:[e]});if(s===200)return console.log(t[0]),t[0].outputs.map(i=>this.toUTxO(i,i.payment_addr.bech32));throw h(t)}catch(t){throw h(t)}}onTxConfirmed(e,t,s=100){let a=0;const i=setInterval(()=>{a>=s&&clearInterval(i),this.fetchTxInfo(e).then(o=>{this.fetchBlockInfo(o.block).then(c=>{(c==null?void 0:c.confirmations)>0&&(clearInterval(i),t())}).catch(()=>{a+=1})}).catch(()=>{a+=1})},5e3)}async submitTx(e){try{const t={"Content-Type":"application/cbor"},{data:s,status:a}=await this._axiosInstance.post("submittx",p(e),{headers:t});if(a===202)return s;throw h(s)}catch(t){throw h(t)}}toUTxO(e,t){var s,a;return{input:{outputIndex:e.tx_index,txHash:e.tx_hash},output:{address:t,amount:[{unit:"lovelace",quantity:e.value},...e.asset_list.map(i=>({unit:`${i.policy_id}${i.asset_name}`,quantity:`${i.quantity}`}))],dataHash:e.datum_hash??void 0,plutusData:((s=e.inline_datum)==null?void 0:s.bytes)??void 0,scriptRef:this.resolveScriptRef(e.reference_script),scriptHash:((a=e.reference_script)==null?void 0:a.hash)??void 0}}}resolveScriptRef=e=>{if(e){const t=e.type.startsWith("plutus")?{code:e.bytes,version:e.type.replace("plutus","")}:kt(Dt(e.bytes));return ht(t).to_hex()}}}class or{_baseUrl;constructor(...e){this._baseUrl=ye(e[0])?Ze[e[0]]:e[0]}async evaluateTx(e){const t=await this.open();return this.send(t,"EvaluateTx",{evaluate:e}),new Promise((s,a)=>{t.addEventListener("message",i=>{try{const{result:o}=JSON.parse(i.data);o.EvaluationResult?s(Object.keys(o.EvaluationResult).map(c=>({index:parseInt(c.split(":")[1],10),tag:c.split(":")[0].toUpperCase(),budget:{mem:o.EvaluationResult[c].memory,steps:o.EvaluationResult[c].steps}}))):a(o.EvaluationFailure),t.close()}catch(o){a(o)}},{once:!0})})}async onNextTx(e){const t=await this.open();return this.send(t,"AwaitAcquire",{}),t.addEventListener("message",s=>{const{result:a}=JSON.parse(s.data);if(a===null)return this.send(t,"AwaitAcquire",{});a.AwaitAcquired===void 0&&e(a),this.send(t,"NextTx",{})}),()=>t.close()}async submitTx(e){const t=await this.open();return this.send(t,"SubmitTx",{submit:e}),new Promise((s,a)=>{t.addEventListener("message",i=>{try{const{result:o}=JSON.parse(i.data);o.SubmitSuccess?s(o.SubmitSuccess.txId):a(o.SubmitFail),t.close()}catch(o){a(o)}},{once:!0})})}async open(){const e=new WebSocket(this._baseUrl);return await new Promise(t=>{e.addEventListener("open",()=>t(!0),{once:!0})}),e}send(e,t,s){e.send(JSON.stringify({version:"1.0",type:"jsonwsp/request",servicename:"ogmios",methodname:t,args:s}))}}class cr{_axiosInstance;constructor(e,t,s,a=1){this._axiosInstance=G.default.create({baseURL:`https://cardano-${e}.tangocrypto.com/${t}/v${a}`,headers:{"x-api-key":s}})}async evaluateTx(e){try{const{data:t,status:s}=await this._axiosInstance.post("transactions/evaluate",{tx:e,utxos:[]});if(s===200)return t.redeemers.map(a=>({index:a.index,tag:a.purpose.toUpperCase(),budget:{mem:a.unit_mem,steps:a.unit_steps}}));throw h(t)}catch(t){throw h(t)}}async fetchAccountInfo(e){try{const t=e.startsWith("addr")?pt(e):e,{data:s,status:a}=await this._axiosInstance.get(`wallets/${t}`);if(a===200)return{poolId:s.pool_id,active:s.active,balance:s.controlled_total_stake,rewards:s.rewards_sum,withdrawals:s.withdrawals_sum};throw h(s)}catch(t){throw h(t)}}async fetchAddressUTxOs(e,t){const s=t!==void 0?`/assets/${t}`:"",a=`addresses/${e}${s}/utxos?size=50`,i=async(d="",g=[])=>{var I;const{data:l,status:A}=await this._axiosInstance.get(`${a}&cursor=${d}`);if(A===200)return l.cursor!==null&&((I=l.cursor)==null?void 0:I.length)>0?i(l.cursor,[...g,...l.data.map(u)]):l.data.map(u);throw h(l)},o=(d,g)=>{const l=[{unit:"lovelace",quantity:d.toString()}];return g.forEach(A=>{const I=b(A.asset_name);l.push({unit:`${A.policy_id}${I}`,quantity:A.quantity.toString()})}),l},c=d=>{if(d){const g=d.type.startsWith("plutus")?{code:d.code,version:d.type.replace("plutus","")}:kt(Dt(d.json));return ht(g).to_hex()}},u=d=>{var g;return{input:{outputIndex:d.index,txHash:d.hash},output:{address:e,amount:o(d.value,d.assets),dataHash:void 0,plutusData:((g=d.inline_datum)==null?void 0:g.value_raw)??void 0,scriptRef:c(d.reference_script)}}};try{return await i()}catch{return[]}}async fetchAssetAddresses(e){const t=a=>({address:a.address,quantity:a.quantity.toString()}),s=async(a="",i=[])=>{var g;const{policyId:o,assetName:c}=z(e),{data:u,status:d}=await this._axiosInstance.get(`assets/${o}${c}/addresses?size=100&cursor=${a}`);if(d===200)return u.cursor!==null&&((g=u.cursor)==null?void 0:g.length)>0?s(u.cursor,[...i,...u.data.map(t)]):u.data.map(t);throw h(u)};try{return await s()}catch{return[]}}async fetchAssetMetadata(e){var t;try{const{policyId:s,assetName:a}=z(e),{data:i,status:o}=await this._axiosInstance.get(`assets/${s}${a}`);if(o===200)return{...(t=i.metadata.find(c=>c.label===721))==null?void 0:t.json[s][qt(a)]};throw h(i)}catch(s){throw h(s)}}async fetchBlockInfo(e){try{const{data:t,status:s}=await this._axiosInstance.get(`blocks/${e}`);if(s===200)return{confirmations:t.confirmations,epoch:t.epoch_no,epochSlot:t.epoch_slot_no.toString(),fees:t.fees.toString(),hash:t.hash,nextBlock:t.next_block.toString()??"",operationalCertificate:t.op_cert,output:t.out_sum.toString()??"0",previousBlock:t.previous_block.toString(),size:t.size,slot:t.slot_no.toString(),slotLeader:t.slot_leader??"",time:Date.parse(t.time),txCount:t.tx_count,VRFKey:t.vrf_key};throw h(t)}catch(t){throw h(t)}}async fetchCollectionAssets(e,t=""){try{const{data:s,status:a}=await this._axiosInstance.get(`policies/${e}/assets?size=100&cursor=${t}`);if(a===200)return{assets:s.data.map(i=>({unit:`${i.policy_id}${i.asset_name}`,quantity:i.quantity})),next:s.cursor};throw h(s)}catch{return{assets:[],next:null}}}async fetchHandleAddress(e){try{const t=b(e.replace("$","")),{data:s,status:a}=await this._axiosInstance.get(`assets/${Ht[1]}${t}/addresses`);if(a===200)return s.data[0].address;throw h(s)}catch(t){throw h(t)}}async fetchProtocolParameters(e){try{const{data:t,status:s}=await this._axiosInstance.get(`epochs/${e}/parameters`);if(s===200)return{coinsPerUTxOSize:t.coins_per_utxo_size.toString(),collateralPercent:t.collateral_percent,decentralisation:t.decentralisation,epoch:t.epoch_no,keyDeposit:t.key_deposit.toString(),maxBlockExMem:t.max_block_ex_mem.toString(),maxBlockExSteps:t.max_block_ex_steps.toString(),maxBlockHeaderSize:t.max_block_header_size,maxBlockSize:t.max_block_size,maxCollateralInputs:t.max_collateral_inputs,maxTxExMem:t.max_tx_ex_mem.toString(),maxTxExSteps:t.max_tx_ex_steps.toString(),maxTxSize:t.max_tx_size,maxValSize:t.max_val_size.toString(),minFeeA:t.min_fee_a,minFeeB:t.min_fee_b,minPoolCost:t.min_pool_cost.toString(),poolDeposit:t.pool_deposit.toString(),priceMem:t.price_mem,priceStep:t.price_step};throw h(t)}catch(t){throw h(t)}}async fetchTxInfo(e){try{const{data:t,status:s}=await this._axiosInstance.get(`transactions/${e}`);if(s===200)return{block:t.block.hash,deposit:t.deposit,fees:t.fee,hash:t.hash,index:t.block_index,invalidAfter:t.invalid_hereafter??"",invalidBefore:t.invalid_before??"",slot:t.block.slot_no.toString(),size:t.size};throw h(t)}catch(t){throw h(t)}}async fetchUTxOs(e){try{return[]}catch(t){throw h(t)}}onTxConfirmed(e,t,s=100){let a=0;const i=setInterval(()=>{a>=s&&clearInterval(i),this.fetchTxInfo(e).then(o=>{this.fetchBlockInfo(o.block).then(c=>{(c==null?void 0:c.confirmations)>0&&(clearInterval(i),t())}).catch(()=>{a+=1})}).catch(()=>{a+=1})},5e3)}async submitTx(e){try{const t={"Content-Type":"application/json"},{data:s,status:a}=await this._axiosInstance.post("transactions/submit",{tx:e},{headers:t});if(a===200)return s.tx_id;throw h(s)}catch(t){throw h(t)}}}class ur{_axiosInstance;_amountsAsStrings={headers:{"amounts-as-strings":"true"}};submitUrl;constructor({network:e,apiKey:t,turboSubmit:s=!1}){this._axiosInstance=G.default.create({baseURL:`https://${e}.gomaestro-api.org/v1`,headers:{"api-key":t}}),this.submitUrl=s?"txmanager/turbosubmit":"txmanager"}async evaluateTx(e){try{const{data:t,status:s}=await this._axiosInstance.post("transactions/evaluate",{cbor:e});if(s===200){const a={spend:"SPEND",mint:"MINT",cert:"CERT",wdrl:"REWARD"};return t.map(o=>{const c=o.ex_units,u=o.redeemer_index,d=a[o.redeemer_tag];return{budget:c,index:u,tag:d}})}throw h(t)}catch(t){throw h(t)}}async fetchAccountInfo(e){const t=e.startsWith("addr")?pt(e):e;try{const{data:s,status:a}=await this._axiosInstance.get(`accounts/${t}`,this._amountsAsStrings);if(a===200){const i=s.data;return{poolId:i.delegated_pool,active:i.registered,balance:i.total_balance,rewards:i.rewards_available,withdrawals:i.total_withdrawn}}throw h(s)}catch(s){throw h(s)}}async fetchAddressUTxOs(e,t){const s=(()=>e.startsWith("addr_vkh")||e.startsWith("addr_shared_vkh")?`addresses/cred/${e}`:`addresses/${e}`)(),a=t?`&asset=${t}`:"",i=async(o=null,c=[])=>{const u=o===null?"":`&cursor=${o}`,{data:d,status:g}=await this._axiosInstance.get(`${s}/utxos?count=100${a}${u}`,this._amountsAsStrings);if(g===200){const A=d.data.map(this.toUTxO),I=[...c,...A],x=d.next_cursor;return x==null?I:i(x,I)}throw h(d)};try{return await i()}catch{return[]}}async fetchAssetAddresses(e){const{policyId:t,assetName:s}=z(e),a=async(i=null,o=[])=>{const c=i===null?"":`&cursor=${i}`,{data:u,status:d}=await this._axiosInstance.get(`assets/${t}${s}/addresses?count=100${c}`,this._amountsAsStrings);if(d===200){const l=u.data.map(x=>({address:x.address,quantity:x.amount})),A=u.next_cursor,I=[...o,...l];return A==null?I:a(A,I)}throw h(u)};try{return await a()}catch{return[]}}async fetchAssetMetadata(e){try{const{policyId:t,assetName:s}=z(e),{data:a,status:i}=await this._axiosInstance.get(`assets/${t}${s}`);if(i===200){const o=a.data;return{...o.asset_standards.cip25_metadata,...o.asset_standards.cip68_metadata}}throw h(a)}catch(t){throw h(t)}}async fetchBlockInfo(e){var t;try{const{data:s,status:a}=await this._axiosInstance.get(`blocks/${e}`,this._amountsAsStrings);if(a===200){const i=s.data;return{confirmations:i.confirmations,epoch:i.epoch,epochSlot:i.epoch_slot.toString(),fees:i.total_fees,hash:i.hash,nextBlock:i.next_block??"",operationalCertificate:(t=i.operational_certificate)==null?void 0:t.hot_vkey,output:i.total_output_lovelace??"0",previousBlock:i.previous_block,size:i.size,slot:i.absolute_slot.toString(),slotLeader:i.block_producer??"",time:Date.parse(i.timestamp)/1e3,txCount:i.tx_hashes.length,VRFKey:n.VRFVKey.from_hex(i.vrf_key).to_bech32("vrf_vk")}}throw h(s)}catch(s){throw h(s)}}async fetchCollectionAssets(e,t){try{const{data:s,status:a}=await this._axiosInstance.get(`policy/${e}/assets?count=100${t?`&cursor=${t}`:""}`);if(a===200)return{assets:s.data.map(o=>({unit:e+o.asset_name,quantity:o.total_supply})),next:s.next_cursor};throw h(s)}catch{return{assets:[],next:null}}}async fetchHandleAddress(e){try{const t=e.charAt(0)==="$"?e.substring(1):e,{data:s,status:a}=await this._axiosInstance.get(`ecosystem/adahandle/${t}`);if(a===200)return s.data;throw h(s)}catch(t){throw h(t)}}async fetchProtocolParameters(e=Number.NaN){if(!isNaN(e))throw new Error("Maestro only supports fetching Protocol parameters of the latest completed epoch.");const t=s=>{const a=s.indexOf("/");return parseInt(s.slice(0,a))/parseInt(s.slice(a+1))};try{const{data:s,status:a}=await this._axiosInstance.get("protocol-params");if(a===200){const i=s.data;try{const{data:o,status:c}=await this._axiosInstance.get("epochs/current");if(c===200){const u=o.data;return{coinsPerUTxOSize:i.coins_per_utxo_byte.toString(),collateralPercent:parseInt(i.collateral_percentage),decentralisation:0,epoch:parseInt(u.epoch_no),keyDeposit:i.stake_key_deposit.toString(),maxBlockExMem:i.max_execution_units_per_block.memory.toString(),maxBlockExSteps:i.max_execution_units_per_block.steps.toString(),maxBlockHeaderSize:parseInt(i.max_block_header_size),maxBlockSize:parseInt(i.max_block_body_size),maxCollateralInputs:parseInt(i.max_collateral_inputs),maxTxExMem:i.max_execution_units_per_transaction.memory.toString(),maxTxExSteps:i.max_execution_units_per_transaction.steps.toString(),maxTxSize:parseInt(i.max_tx_size),maxValSize:i.max_value_size.toString(),minFeeA:i.min_fee_coefficient,minFeeB:i.min_fee_constant,minPoolCost:i.min_pool_cost.toString(),poolDeposit:i.pool_deposit.toString(),priceMem:t(i.prices.memory),priceStep:t(i.prices.steps)}}throw h(o)}catch(o){throw h(o)}}throw h(s)}catch(s){throw h(s)}}async fetchTxInfo(e){try{const{data:t,status:s}=await this._axiosInstance.get(`transactions/${e}`);if(s===200){const a=t.data;return{block:a.block_hash,deposit:a.deposit.toString(),fees:a.fee.toString(),hash:a.tx_hash,index:a.block_tx_index,invalidAfter:a.invalid_hereafter??"",invalidBefore:a.invalid_before??"",slot:a.block_absolute_slot.toString(),size:a.size-1}}throw h(t)}catch(t){throw h(t)}}async fetchUTxOs(e){try{const{data:t,status:s}=await this._axiosInstance.get(`transactions/${e}`,this._amountsAsStrings);if(s===200)return t.data.outputs.map(this.toUTxO);throw h(t)}catch(t){throw h(t)}}onTxConfirmed(e,t,s=100){let a=0;const i=setInterval(()=>{a>=s&&clearInterval(i),this.fetchTxInfo(e).then(o=>{this.fetchBlockInfo(o.block).then(c=>{(c==null?void 0:c.confirmations)>0&&(clearInterval(i),t())}).catch(()=>{a+=1})}).catch(()=>{a+=1})},5e3)}async submitTx(e){try{const t={"Content-Type":"application/cbor"},{data:s,status:a}=await this._axiosInstance.post(this.submitUrl,p(e),{headers:t});if(a===202)return s;throw h(s)}catch(t){throw h(t)}}toUTxO=e=>{var t,s,a;return{input:{outputIndex:e.index,txHash:e.tx_hash},output:{address:e.address,amount:e.assets.map(i=>({unit:i.unit,quantity:i.amount})),dataHash:(t=e.datum)==null?void 0:t.hash,plutusData:(s=e.datum)==null?void 0:s.bytes,scriptRef:this.resolveScript(e),scriptHash:(a=e.reference_script)==null?void 0:a.hash}}};resolveScript=e=>{if(e.reference_script){const t=e.reference_script.type==="native"?e.reference_script.json:{code:e.reference_script.bytes,version:e.reference_script.type.replace("plutusv","V")};return ht(t).to_hex()}else return}}class dr{static withOneSignature(e){const t=F(st(e));return xt(t).to_hex()}static withAtLeastNSignatures(e,t){const s=n.NativeScripts.new();e.forEach(i=>{const o=F(st(i));s.add(xt(o))});const a=n.ScriptNOfK.new(t,s);return n.NativeScript.new_script_any(a).to_hex()}static withAnySignature(e){const t=n.NativeScripts.new();e.forEach(a=>{const i=F(st(a));t.add(xt(i))});const s=n.ScriptAny.new(t);return n.NativeScript.new_script_any(s).to_hex()}static withAllSignatures(e){const t=n.NativeScripts.new();e.forEach(a=>{const i=F(st(a));t.add(xt(i))});const s=n.ScriptAll.new(t);return n.NativeScript.new_script_any(s).to_hex()}static fromNativeScript(e){return Tt(e).to_hex()}}function et(r,e,t,s){var a=arguments.length,i=a<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,s);else for(var c=r.length-1;c>=0;c--)(o=r[c])&&(i=(a<3?o(i):a>3?o(e,t,i):o(e,t))||i);return a>3&&i&&Object.defineProperty(e,t,i),i}const hr=r=>class extends r{__visits=[]},rt=()=>function(r,e,t){const s=t.value;t.value=function(...a){const i=s.call(this,...a);return this.__visits&&this.__visits.push(e),i}};exports.Transaction=class{_changeAddress;_txOutputs=new Map;_recipients=new Map;_totalBurns=new Map;_totalMints=new Map;_era;_initiator;_mintBuilder;_protocolParameters;_txBuilder;_txCertificates;_txInputsBuilder;_txWithdrawals;constructor(e={}){this._era=e.era,this._initiator=e.initiator,this._mintBuilder=n.MintBuilder.new(),this._protocolParameters=e.parameters??D,this._txBuilder=St(e.parameters),this._txCertificates=n.Certificates.new(),this._txInputsBuilder=n.TxInputsBuilder.new(),this._txWithdrawals=n.Withdrawals.new()}static maskMetadata(e,t="BABBAGE"){var i;const s=Y(e),a=(i=s.auxiliary_data())==null?void 0:i.metadata();if(a!==void 0){const o=n.GeneralTransactionMetadata.new();for(let u=0;u<a.len();u+=1){const d=a.keys().get(u),g=a.get(d);o.insert(d,n.TransactionMetadatum.from_hex("0".repeat(((g==null?void 0:g.to_hex())??"").length)))}const c=s.auxiliary_data();return c!==void 0&&(c.set_metadata(o),c.set_prefer_alonzo_format(t==="ALONZO")),n.Transaction.new(s.body(),s.witness_set(),c).to_hex()}return e}static readMetadata(e){var s,a;return((a=(s=Y(e).auxiliary_data())==null?void 0:s.metadata())==null?void 0:a.to_hex())??""}static writeMetadata(e,t,s="BABBAGE"){const a=Y(e),i=a.auxiliary_data()??n.AuxiliaryData.new();return i.set_metadata(n.GeneralTransactionMetadata.from_hex(t)),i.set_prefer_alonzo_format(s==="ALONZO"),n.Transaction.new(a.body(),a.witness_set(),i).to_hex()}get size(){return this._txBuilder.full_size()}async build(){try{return(this._mintBuilder.has_plutus_scripts()||this.notVisited("redeemValue")===!1)&&(await this.addRequiredSignersIfNeeded(),await this.addCollateralIfNeeded()),await this.forgeAssetsIfNeeded(),await this.addTxInputsAsNeeded(),await this.addChangeAddress(),this._txBuilder.build_tx().to_hex()}catch(e){throw new Error(`[Transaction] An error occurred during build: ${e}.`)}}burnAsset(e,t,s){const a=this._totalBurns.has(t.unit)?n.BigNum.from_str(this._totalBurns.get(t.unit)??"0").checked_add(n.BigNum.from_str(t.quantity)).to_str():t.quantity;return this._mintBuilder.add_asset(pe(e,s),n.AssetName.new(p(t.unit.slice(O))),n.Int.new_negative(n.BigNum.from_str(t.quantity))),this._totalBurns.set(t.unit,a),this}delegateStake(e,t){const s=n.Certificate.new_stake_delegation(n.StakeDelegation.new(n.StakeCredential.from_keyhash(F(it(e))),n.Ed25519KeyHash.from_bech32(t)));return this._txCertificates.add(s),this}deregisterStake(e){const t=n.Certificate.new_stake_deregistration(n.StakeDeregistration.new(n.StakeCredential.from_keyhash(F(it(e)))));return this._txCertificates.add(t),this}mintAsset(e,t,s){var d,g;const a=(l,A)=>{const I=typeof l=="string"?Dt(l).hash().to_hex():i(l).hash().to_hex(),x=b(A.assetName);return{unit:`${I}${x}`,quantity:A.assetQuantity}},i=l=>{if("code"in l)return dt(l.code,l.version);const A=H(l);if(A.output().has_script_ref()){const I=A.output().script_ref();if(I.is_plutus_script()){const x=He(I);return dt(x.code,x.version)}}throw new Error(`No plutus script reference found in UTxO: ${A.input().transaction_id().to_hex()}`)},o=a(e,t),u=n.BigNum.from_str(((d=this._totalMints.get(o.unit))==null?void 0:d.assetQuantity)??"0").checked_add(n.BigNum.from_str(o.quantity));return this._mintBuilder.add_asset(pe(e,s),n.AssetName.new(p(b(t.assetName))),n.Int.new(n.BigNum.from_str(o.quantity))),this._recipients.has(t.recipient)?(g=this._recipients.get(t.recipient))==null||g.push(o):this._recipients.set(t.recipient,[o]),this._totalMints.set(o.unit,{...t,assetQuantity:u.to_str()}),this}redeemValue(e){const t={tag:"SPEND",budget:nt,index:this._txInputsBuilder.inputs().len(),data:{alternative:0,fields:[]},...e.redeemer},s=H(e.value),a=n.PlutusWitness.new_with_ref(Ve(e.script),Ls(e.datum),Me(t));return this._txInputsBuilder.add_plutus_script_input(a,s.input(),s.output().amount()),this}registerStake(e){const t=n.Certificate.new_stake_registration(n.StakeRegistration.new(n.StakeCredential.from_keyhash(F(it(e)))));return this._txCertificates.add(t),this}registerPool(e){const t=n.Certificate.new_pool_registration(n.PoolRegistration.new(Rs(e)));return this._txCertificates.add(t),this}retirePool(e,t){const s=n.Certificate.new_pool_retirement(n.PoolRetirement.new(n.Ed25519KeyHash.from_bech32(e),t));return this._txCertificates.add(s),this}sendAssets(e,t){const s=Z(t),a=s.multiasset();if(s.is_zero()||a===void 0)return this;const i=Ct(e).next(),o=s.coin().is_zero()?i.with_asset_and_min_required_coin_by_utxo_cost(a,Kt(this._protocolParameters.coinsPerUTxOSize)).build():i.with_coin_and_asset(s.coin(),a).build();return t.forEach(c=>{this.setTxOutput(c)}),this._txBuilder.add_output(o),this}sendLovelace(e,t){const a=Ct(e).next().with_coin(n.BigNum.from_str(t)).build();return this.setTxOutput({unit:"lovelace",quantity:t}),this._txBuilder.add_output(a),this}sendToken(e,t,s){return this.sendAssets(e,[{quantity:s,unit:ts[t]}]),this}sendValue(e,t){const s=Z(t.output.amount),i=Ct(e).next().with_value(s).build();return t.output.amount.forEach(o=>{this.setTxOutput(o)}),this._txBuilder.add_output(i),this}setChangeAddress(e){return this._changeAddress=K(e),this}setCollateral(e){const t=fe(e);return this._txBuilder.set_collateral(t),this}setMetadata(e,t){return this._txBuilder.add_json_metadatum_with_schema(n.BigNum.from_str(e.toString()),JSON.stringify(t),n.MetadataJsonSchema.NoConversions),this}setRequiredSigners(e){return Array.from(new Set(e.map(s=>s.startsWith("addr")?st(s):it(s)).map(s=>F(s)))).forEach(s=>{this._txBuilder.add_required_signer(s)}),this}setTimeToStart(e){return this._txBuilder.set_validity_start_interval_bignum(n.BigNum.from_str(e)),this}setTimeToExpire(e){return this._txBuilder.set_ttl_bignum(n.BigNum.from_str(e)),this}setTxInputs(e){return e.map(t=>H(t)).forEach(t=>{this._txInputsBuilder.add_input(t.output().address(),t.input(),t.output().amount())}),this}setTxRefInputs(e){return e.map(t=>H(t)).forEach(t=>{this._txBuilder.add_reference_input(t.input())}),this}withdrawRewards(e,t){const s=Ke(e);return s!==void 0&&this._txWithdrawals.insert(s,n.BigNum.from_str(t)),this}async addBurnInputsIfNeeded(){if(this._initiator&&this._totalBurns.size>0&&this.notVisited("setTxInputs")){const e=await this._initiator.getUsedUTxOs();Ce(this._totalBurns,e.map(s=>Qt(s))).map(s=>H(s)).forEach(s=>{this._txInputsBuilder.add_input(s.output().address(),s.input(),s.output().amount())})}}async addChangeAddress(){if(this._initiator&&this._changeAddress===void 0){const e=await this._initiator.getUsedAddress();this._txBuilder.add_change_if_needed(e)}else this._changeAddress!==void 0&&this._txBuilder.add_change_if_needed(this._changeAddress)}async addCollateralIfNeeded(){if(this._initiator&&this.notVisited("setCollateral")){const e=await this._initiator.getUsedCollateral();this._txBuilder.set_collateral(fe(e))}}async addRequiredSignersIfNeeded(){if(this._initiator&&this.notVisited("setRequiredSigners")){const e=await this._initiator.getUsedAddress(),t=st(e.to_bech32());this._txBuilder.add_required_signer(F(t))}}async addTxInputsAsNeeded(){if(this.notVisited("setTxInputs")){const e=await this.filterAvailableUTxOs();xe(this._txOutputs,e.map(s=>Qt(s))).map(s=>H(s)).forEach(s=>{this._txInputsBuilder.add_input(s.output().address(),s.input(),s.output().amount())})}if(this._txBuilder.set_inputs(this._txInputsBuilder),(this._mintBuilder.has_native_scripts()||this._mintBuilder.has_plutus_scripts())&&this._txBuilder.set_mint_builder(this._mintBuilder),this._txCertificates.len()>0&&this._txBuilder.set_certs(this._txCertificates),this._txWithdrawals.len()>0&&this._txBuilder.set_withdrawals(this._txWithdrawals),this._txBuilder.get_mint_builder()||this.notVisited("redeemValue")===!1){const e=this._era!==void 0?Jt[this._era]:Jt.BABBAGE;this._txBuilder.calc_script_data_hash(e)}}async forgeAssetsIfNeeded(){const e=(t,s)=>{const a=t.data.assetName,i=t.data.metadata,o=t.unit.slice(0,O);if(t.data.label==="777")return i;if(s&&s[o]){const{[o]:c,...u}=s,d={[a]:i,...c};return{[o]:{...d},...u}}return s!==void 0?{[o]:{[a]:i},...s}:{[o]:{[a]:i}}};await this.addBurnInputsIfNeeded(),Array.from(this._totalMints,t=>({unit:t[0],data:t[1]})).reduce((t,s)=>t.set(s.data.label,e(s,t.get(s.data.label))),new Map).forEach((t,s)=>{this._txBuilder.add_json_metadatum(n.BigNum.from_str(s),JSON.stringify(t))}),this.addMintOutputs()}async filterAvailableUTxOs(e=[]){return this._initiator===void 0?[]:(await this._initiator.getUsedUTxOs()).filter(s=>e.find(a=>a.input.txHash===s.input().transaction_id().to_hex())===void 0)}addMintOutputs(){this._recipients.forEach((e,t)=>{const a=Z(e).multiasset();if(a!==void 0){const o=Ct(t).next().with_asset_and_min_required_coin_by_utxo_cost(a,Kt(this._protocolParameters.coinsPerUTxOSize)).build();this._txBuilder.add_output(o)}})}notVisited(e){return this.__visits.includes(e)===!1}setTxOutput(e){const s=n.BigNum.from_str(this._txOutputs.get(e.unit)??"0").checked_add(n.BigNum.from_str(e.quantity)).to_str();this._txOutputs.set(e.unit,s)}};et([rt()],exports.Transaction.prototype,"mintAsset",null);et([rt()],exports.Transaction.prototype,"redeemValue",null);et([rt()],exports.Transaction.prototype,"sendAssets",null);et([rt()],exports.Transaction.prototype,"sendValue",null);et([rt()],exports.Transaction.prototype,"setCollateral",null);et([rt()],exports.Transaction.prototype,"setRequiredSigners",null);et([rt()],exports.Transaction.prototype,"setTxInputs",null);exports.Transaction=et([hr],exports.Transaction);class lr{txHex="";txBuilder=St();txEvaluationMultiplier=1.1;_protocolParams=D;txOutput;addingScriptInput=!1;addingPlutusMint=!1;isHydra=!1;meshTxBuilderBody;mintItem;txInQueueItem;collateralQueueItem;refScriptTxInQueueItem;reset=()=>(this.txHex="",this.txBuilder=St(),this.txEvaluationMultiplier=1.1,this._protocolParams=D,this.txOutput=void 0,this.addingScriptInput=!1,this.addingPlutusMint=!1,this.mintItem=void 0,this.txInQueueItem=void 0,this.collateralQueueItem=void 0,this.refScriptTxInQueueItem=void 0,this.meshTxBuilderBody=this.emptyTxBuilderBody(),this);emptyTxBuilderBody=()=>({inputs:[],outputs:[],collaterals:[],requiredSignatures:[],referenceInputs:[],mints:[],changeAddress:"",metadata:[],validityRange:{},signingKey:[]});constructor(){this.meshTxBuilderBody=this.emptyTxBuilderBody()}completeSync=e=>(e&&(this.meshTxBuilderBody=e),this.serializeTxBody(this.meshTxBuilderBody));completeSigning=()=>{const{signingKey:e}=this.meshTxBuilderBody;return e.length>0&&this.addAllSigningKeys(e),this.txHex};serializeTxBody=e=>{const{inputs:t,outputs:s,collaterals:a,referenceInputs:i,mints:o,changeAddress:c,validityRange:u,requiredSignatures:d,metadata:g}=e;if(this.isHydra?this.protocolParams({minFeeA:0,minFeeB:0,priceMem:0,priceStep:0,collateralPercent:0,coinsPerUTxOSize:"0"}):this.protocolParams({}),this.meshTxBuilderBody.mints.sort((l,A)=>l.policyId.localeCompare(A.policyId)),this.meshTxBuilderBody.inputs.sort((l,A)=>l.txIn.txHash===A.txIn.txHash?l.txIn.txIndex-A.txIn.txIndex:l.txIn.txHash.localeCompare(A.txIn.txHash)),this.addAllInputs(t),this.addAllOutputs(s),this.addAllCollaterals(a),this.addAllReferenceInputs(i),this.addAllMints(o),this.addValidityRange(u),this.addAllRequiredSignatures(d),this.addAllMetadata(g),this.addCostModels(),c){const l=this.meshTxBuilderBody.collaterals.map(A=>{var I,x;return((x=(I=A.txIn.amount)==null?void 0:I.find(T=>T.unit==="lovelace"))==null?void 0:x.quantity)||"0"}).reduce((A,I)=>A+parseInt(I),0);l>0&&(this.txBuilder.set_collateral_return(n.TransactionOutput.new(n.Address.from_bech32(c),n.Value.new(n.BigNum.from_str(String(l))))),this.txBuilder.set_total_collateral(n.BigNum.from_str(String(l)))),this.addChange(c),this.addCollateralReturn(c)}return this.buildTx(),this};txIn=(e,t,s,a)=>(this.txInQueueItem&&this.queueInput(),this.addingScriptInput?this.txInQueueItem={type:"Script",txIn:{txHash:e,txIndex:t,amount:s,address:a},scriptTxIn:{}}:this.txInQueueItem={type:"PubKey",txIn:{txHash:e,txIndex:t,amount:s,address:a}},this.addingScriptInput=!1,this);txInScript=(e,t="V2")=>{if(!this.txInQueueItem)throw Error("Undefined input");if(this.txInQueueItem.type==="PubKey")throw Error("Datum value attempted to be called a non script input");return this.txInQueueItem.scriptTxIn.scriptSource={type:"Provided",script:{code:e,version:t}},this};txInDatumValue=(e,t="Mesh")=>{if(!this.txInQueueItem)throw Error("Undefined input");if(this.txInQueueItem.type==="PubKey")throw Error("Datum value attempted to be called a non script input");if(t==="Mesh")return this.txInQueueItem.scriptTxIn.datumSource={type:"Provided",data:{type:t,content:e}},this;const s=this.castRawDataToJsonString(e);return this.txInQueueItem.scriptTxIn.datumSource={type:"Provided",data:{type:t,content:s}},this};txInInlineDatumPresent=()=>{if(!this.txInQueueItem)throw Error("Undefined input");if(this.txInQueueItem.type==="PubKey")throw Error("Inline datum present attempted to be called a non script input");const{txHash:e,txIndex:t}=this.txInQueueItem.txIn;return e&&t.toString()&&(this.txInQueueItem.scriptTxIn.datumSource={type:"Inline",txHash:e,txIndex:t}),this};txInRedeemerValue=(e,t={...nt},s="Mesh")=>{if(!this.txInQueueItem)throw Error("Undefined input");if(this.txInQueueItem.type==="PubKey")throw Error("Spending tx in reference redeemer attempted to be called a non script input");if(s==="Mesh")return this.txInQueueItem.scriptTxIn.redeemer={data:{type:s,content:e},exUnits:t},this;const a=this.castRawDataToJsonString(e);return this.txInQueueItem.scriptTxIn.redeemer={data:{type:s,content:a},exUnits:t},this};txOut=(e,t)=>(this.txOutput&&(this.meshTxBuilderBody.outputs.push(this.txOutput),this.txOutput=void 0),this.txOutput={address:e,amount:t},this);txOutDatumHashValue=(e,t="Mesh")=>{if(this.txOutput){if(t==="Mesh")return this.txOutput.datum={type:"Hash",data:{type:t,content:e}},this;const s=this.castRawDataToJsonString(e);this.txOutput.datum={type:"Hash",data:{type:t,content:s}}}return this};txOutInlineDatumValue=(e,t="Mesh")=>{if(this.txOutput){if(t==="Mesh")return this.txOutput.datum={type:"Inline",data:{type:t,content:e}},this;const s=this.castRawDataToJsonString(e);this.txOutput.datum={type:"Inline",data:{type:t,content:s}}}return this};txOutReferenceScript=(e,t="V2")=>(this.txOutput&&(this.txOutput.referenceScript={code:e,version:t}),this);spendingPlutusScriptV2=()=>(this.addingScriptInput=!0,this);spendingTxInReference=(e,t,s,a="V2")=>{if(!this.txInQueueItem)throw Error("Undefined input");if(this.txInQueueItem.type==="PubKey")throw Error("Spending tx in reference attempted to be called a non script input");return this.txInQueueItem.scriptTxIn.scriptSource={type:"Inline",txInInfo:{txHash:e,txIndex:t,spendingScriptHash:s,version:a}},this};spendingReferenceTxInInlineDatumPresent=()=>(this.txInInlineDatumPresent(),this);spendingReferenceTxInRedeemerValue=(e,t={...nt})=>(this.txInRedeemerValue(e,t),this);readOnlyTxInReference=(e,t)=>(this.meshTxBuilderBody.referenceInputs.push({txHash:e,txIndex:t}),this);mintPlutusScriptV2=()=>(this.addingPlutusMint=!0,this);mint=(e,t,s)=>(this.mintItem&&this.queueMint(),this.mintItem={type:this.addingPlutusMint?"Plutus":"Native",policyId:t,assetName:s,amount:e},this.addingPlutusMint=!1,this);mintingScript=(e,t="V2")=>{if(!this.mintItem)throw Error("Undefined mint");if(!this.mintItem.type)throw Error("Mint information missing");return this.mintItem.scriptSource={type:"Provided",script:{code:e,version:t}},this};mintTxInReference=(e,t,s="V2")=>{if(!this.mintItem)throw Error("Undefined mint");if(!this.mintItem.type)throw Error("Mint information missing");if(this.mintItem.type=="Native")throw Error("Mint tx in reference can only be used on plutus script tokens");if(!this.mintItem.policyId)throw Error("PolicyId information missing from mint asset");return this.mintItem.scriptSource={type:"Reference Script",txHash:e,txIndex:t,version:s},this};mintReferenceTxInRedeemerValue=(e,t={...nt},s="Mesh")=>{if(!this.mintItem)throw Error("Undefined mint");if(this.mintItem.type=="Native")throw Error("Mint tx in reference can only be used on plutus script tokens");if(this.mintItem.type=="Plutus"){if(!this.mintItem.policyId)throw Error("PolicyId information missing from mint asset");if(s==="Mesh")return this.mintItem.redeemer={data:{type:s,content:e},exUnits:t},this;const a=this.castRawDataToJsonString(e);this.mintItem.redeemer={data:{type:s,content:a},exUnits:t}}return this};mintRedeemerValue=(e,t={...nt},s="Mesh")=>(this.mintReferenceTxInRedeemerValue(e,t,s),this);requiredSignerHash=e=>(this.meshTxBuilderBody.requiredSignatures.push(e),this);txInCollateral=(e,t,s,a)=>(this.collateralQueueItem&&this.meshTxBuilderBody.collaterals.push(this.collateralQueueItem),this.collateralQueueItem={type:"PubKey",txIn:{txHash:e,txIndex:t,amount:s,address:a}},this);changeAddress=e=>(this.meshTxBuilderBody.changeAddress=e,this);invalidBefore=e=>(this.meshTxBuilderBody.validityRange.invalidBefore=e,this);invalidHereafter=e=>(this.meshTxBuilderBody.validityRange.invalidHereafter=e,this);metadataValue=(e,t)=>(this.meshTxBuilderBody.metadata.push({tag:e,metadata:t}),this);protocolParams=e=>{const t={...D,...e};return this._protocolParams=t,this.txBuilder=St(t),this};signingKey=e=>(this.meshTxBuilderBody.signingKey.push(e),this);addAllSigningKeys=e=>{if(e.length>0){const t=n.Vkeywitnesses.new(),s=n.Transaction.from_hex(this.txHex),a=s.body();e.forEach(c=>{const u=c.slice(0,4)==="5820"?c.slice(4):c,d=n.PrivateKey.from_hex(u),g=n.make_vkey_witness(n.hash_transaction(a),d);t.add(g)});const i=s.witness_set();i.set_vkeys(t);const o=n.Transaction.new(a,i,s.auxiliary_data());this.txHex=o.to_hex()}};buildTx=()=>{const e=this.txBuilder.build_tx();this.txHex=e.to_hex()};queueInput=()=>{if(!this.txInQueueItem)throw Error("Undefined input");if(this.txInQueueItem.type==="Script")if(this.txInQueueItem.scriptTxIn){if(!this.txInQueueItem.scriptTxIn.datumSource)throw Error("Script input does not contain datum information");if(!this.txInQueueItem.scriptTxIn.redeemer)throw Error("Script input does not contain redeemer information");if(!this.txInQueueItem.scriptTxIn.scriptSource)throw Error("Script input does not contain script information")}else throw Error("Script input does not contain script, datum, or redeemer information");this.meshTxBuilderBody.inputs.push(this.txInQueueItem),this.txInQueueItem=void 0};queueMint=()=>{if(!this.mintItem)throw Error("Undefined mint");if(!this.mintItem.scriptSource)throw Error("Missing mint script information");this.meshTxBuilderBody.mints.push(this.mintItem),this.mintItem=void 0};makePlutusScriptSource=e=>{const t=n.ScriptHash.from_hex(e.spendingScriptHash),s=n.TransactionInput.new(n.TransactionHash.from_hex(e.txHash),e.txIndex);return n.PlutusScriptSource.new_ref_input_with_lang_ver(t,s,q[e.version])};addAllInputs=e=>{for(let t=0;t<e.length;t++){const s=e[t];switch(s.type){case"PubKey":this.addTxIn(s);break;case"Script":this.addScriptTxIn(s);break}}};addTxIn=e=>{this.txBuilder.add_input(n.Address.from_bech32(e.txIn.address),n.TransactionInput.new(n.TransactionHash.from_hex(e.txIn.txHash),e.txIn.txIndex),Z(e.txIn.amount))};addScriptTxIn=({scriptTxIn:e,txIn:t})=>{let s;const{datumSource:a,scriptSource:i,redeemer:o}=e;if(a.type==="Provided")s=n.DatumSource.new(this.castDataToPlutusData(a.data));else{const d=n.TransactionInput.new(n.TransactionHash.from_hex(a.txHash),a.txIndex);s=n.DatumSource.new_ref_input(d)}let c;i.type=="Inline"?c=this.makePlutusScriptSource(i.txInInfo):c=n.PlutusScriptSource.new(n.PlutusScript.from_hex_with_version(i.script.code,q[i.script.version]));const u=n.Redeemer.new(n.RedeemerTag.new_spend(),n.BigNum.from_str("0"),this.castDataToPlutusData(o.data),n.ExUnits.new(n.BigNum.from_str(String(o.exUnits.mem)),n.BigNum.from_str(String(o.exUnits.steps))));this.txBuilder.add_plutus_script_input(n.PlutusWitness.new_with_ref(c,s,u),n.TransactionInput.new(n.TransactionHash.from_hex(t.txHash),t.txIndex),Z(t.amount))};addAllOutputs=e=>{for(let t=0;t<e.length;t++){const s=e[t];this.addOutput(s)}};addOutput=({amount:e,address:t,datum:s,referenceScript:a})=>{const i=Z(e),o=i.multiasset();if(i.is_zero()&&o===void 0)throw Error("Invalid output amount");let c=n.TransactionOutputBuilder.new().with_address(K(t));s&&s.type==="Hash"&&(c=c.with_data_hash(n.hash_plutus_data(this.castDataToPlutusData(s.data)))),s&&s.type==="Inline"&&(c=c.with_plutus_data(this.castDataToPlutusData(s.data))),a&&(c=c.with_script_ref(n.ScriptRef.new_plutus_script(n.PlutusScript.from_hex_with_version(a.code,q[a.version]))));const u=c.next();if(o){const d=i.coin().is_zero()?u.with_asset_and_min_required_coin_by_utxo_cost(o,Kt(this._protocolParams.coinsPerUTxOSize)).build():u.with_coin_and_asset(i.coin(),o).build();this.txBuilder.add_output(d)}else{const d=u.with_coin(i.coin()).build();this.txBuilder.add_output(d)}};addAllCollaterals=e=>{const t=n.TxInputsBuilder.new();for(let s=0;s<e.length;s++){const a=e[s];this.addCollateral(t,a)}this.txBuilder.set_collateral(t)};addCollateral=(e,t)=>{e.add_input(n.Address.from_bech32(t.txIn.address),n.TransactionInput.new(n.TransactionHash.from_hex(t.txIn.txHash),t.txIn.txIndex),Z(t.txIn.amount))};addCollateralReturn=e=>{var s;const t=(s=this.txBuilder.get_fee_if_set())==null?void 0:s.to_js_value();if(t){const a=Math.ceil(this._protocolParams.collateralPercent*Number(t)/100);this.txBuilder.set_total_collateral_and_return(n.BigNum.from_str(String(a)),n.Address.from_bech32(e))}};addAllReferenceInputs=e=>{e.forEach(t=>{this.addReferenceInput(t)})};addReferenceInput=({txHash:e,txIndex:t})=>{const s=n.TransactionInput.new(n.TransactionHash.from_hex(e),t);this.txBuilder.add_reference_input(s)};addAllMints=e=>{const t=n.MintBuilder.new();let s=0;for(let a=0;a<e.length;a++){const i=e[a];if(!i.scriptSource)throw Error("Mint script is expected to be provided");if(i.type==="Plutus"){if(!i.redeemer)throw Error("Missing mint redeemer information");this.addPlutusMint(t,i,s),s++}else i.type==="Native"&&this.addNativeMint(t,i)}this.txBuilder.set_mint_builder(t)};addPlutusMint=(e,{redeemer:t,policyId:s,scriptSource:a,assetName:i,amount:o},c)=>{const u=n.Redeemer.new(n.RedeemerTag.new_mint(),n.BigNum.from_str(String(c)),this.castDataToPlutusData(t.data),n.ExUnits.new(n.BigNum.from_str(String(t.exUnits.mem)),n.BigNum.from_str(String(t.exUnits.steps)))),d=a.type==="Reference Script"?n.PlutusScriptSource.new_ref_input_with_lang_ver(n.ScriptHash.from_hex(s),n.TransactionInput.new(n.TransactionHash.from_hex(a.txHash),a.txIndex),q[a.version]):n.PlutusScriptSource.new(n.PlutusScript.from_hex_with_version(a.script.code,q[a.script.version]));e.add_asset(n.MintWitness.new_plutus_script(d,u),n.AssetName.new(Buffer.from(i,"hex")),n.Int.new_i32(o))};addNativeMint=(e,{scriptSource:t,assetName:s,amount:a})=>{if(t.type==="Reference Script")throw Error("Native mint cannot have reference script");e.add_asset(n.MintWitness.new_native_script(n.NativeScript.from_hex(t.script.code)),n.AssetName.new(Buffer.from(s,"hex")),n.Int.new_i32(a))};queueAllLastItem=()=>{this.txOutput&&(this.meshTxBuilderBody.outputs.push(this.txOutput),this.txOutput=void 0),this.txInQueueItem&&this.queueInput(),this.collateralQueueItem&&this.meshTxBuilderBody.collaterals.push(this.collateralQueueItem),this.mintItem&&this.queueMint()};addCostModels=()=>{this.txBuilder.calc_script_data_hash(n.TxBuilderConstants.plutus_vasil_cost_models())};addChange=e=>{this.txBuilder.add_change_if_needed(n.Address.from_bech32(e))};addValidityRange=({invalidBefore:e,invalidHereafter:t})=>{e&&this.txBuilder.set_validity_start_interval_bignum(n.BigNum.from_str(e.toString())),t&&this.txBuilder.set_ttl_bignum(n.BigNum.from_str(t.toString()))};addAllRequiredSignatures=e=>{e.forEach(t=>{this.txBuilder.add_required_signer(n.Ed25519KeyHash.from_hex(t))})};addAllMetadata=e=>{e.forEach(({tag:t,metadata:s})=>{this.txBuilder.add_json_metadatum(n.BigNum.from_str(t),JSON.stringify(s))})};updateRedeemer=(e,t)=>{t.forEach(s=>{switch(s.tag){case"SPEND":{const a=e.inputs[s.index];a.type=="Script"&&a.scriptTxIn.redeemer&&(a.scriptTxIn.redeemer.exUnits.mem=Math.floor(s.budget.mem*this.txEvaluationMultiplier),a.scriptTxIn.redeemer.exUnits.steps=Math.floor(s.budget.steps*this.txEvaluationMultiplier));break}case"MINT":{const a=e.mints[s.index];a.type=="Plutus"&&a.redeemer&&(a.redeemer.exUnits.mem=Math.floor(s.budget.mem*this.txEvaluationMultiplier),a.redeemer.exUnits.steps=Math.floor(s.budget.steps*this.txEvaluationMultiplier));break}}})};castRawDataToJsonString=e=>typeof e=="object"?JSON.stringify(e):e;castDataToPlutusData=({type:e,content:t})=>e==="Mesh"?tt(t):n.PlutusData.from_json(t,n.PlutusDatumSchema.DetailedSchema)}class gr extends lr{_fetcher;_submitter;_evaluator;queriedTxHashes=new Set;queriedUTxOs={};constructor({fetcher:e,submitter:t,evaluator:s,isHydra:a=!1}){super(),e&&(this._fetcher=e),t&&(this._submitter=t),s&&(this._evaluator=s),a&&(this.isHydra=!0)}complete=async e=>{e?this.meshTxBuilderBody=e:this.queueAllLastItem(),await this.queryAllTxInfo();const{inputs:t,collaterals:s}=this.meshTxBuilderBody;if([...t,...s].forEach(a=>{this.completeTxInformation(a)}),this.completeSync(e),this._evaluator){const a=await this._evaluator.evaluateTx(this.txHex);this.updateRedeemer(this.meshTxBuilderBody,a),this.completeSync(e)}return this};submitTx=async e=>{var s;return await((s=this._submitter)==null?void 0:s.submitTx(e))};getUTxOInfo=async e=>{var s;let t=[];this.queriedTxHashes.has(e)||(this.queriedTxHashes.add(e),t=await((s=this._fetcher)==null?void 0:s.fetchUTxOs(e))||[],this.queriedUTxOs[e]=t)};queryAllTxInfo=()=>{var a,i;const e=[],{inputs:t,collaterals:s}=this.meshTxBuilderBody;if(t.length+s.length>0&&!this._fetcher)throw Error("Transaction information is incomplete while no fetcher instance is provided");for(let o=0;o<t.length;o++){const c=t[o];if((!c.txIn.amount||!c.txIn.address)&&e.push(this.getUTxOInfo(c.txIn.txHash)),c.type==="Script"&&((a=c.scriptTxIn.scriptSource)==null?void 0:a.type)=="Inline"&&c.scriptTxIn.scriptSource.txInInfo&&!((i=c.scriptTxIn.scriptSource)!=null&&i.txInInfo.spendingScriptHash)){const u=c.scriptTxIn.scriptSource.txInInfo.txHash;e.push(this.getUTxOInfo(u))}}for(let o=0;o<s.length;o++){const c=s[o];(!c.txIn.amount||!c.txIn.address)&&e.push(this.getUTxOInfo(c.txIn.txHash))}return Promise.all(e)};completeTxInformation=e=>{var o;const s=this.queriedUTxOs[e.txIn.txHash].find(c=>c.input.outputIndex===e.txIn.txIndex),a=s==null?void 0:s.output.address,i=s==null?void 0:s.output.amount;if(!a||a===""||!i||i.length===0)throw Error(`Couldn't find information for ${e.txIn.txHash}#${e.txIn.txIndex}`);if(e.txIn.address=a,e.txIn.amount=i,e.type==="Script"&&((o=e.scriptTxIn.scriptSource)==null?void 0:o.type)=="Inline"){const c=e.scriptTxIn.scriptSource.txInInfo;if(!c.spendingScriptHash){const d=this.queriedUTxOs[c.txHash].find(g=>g.input.outputIndex===c.txIndex);if(!d)throw Error(`Couldn't find script reference utxo for ${c.txHash}#${c.txIndex}`);c.spendingScriptHash=d==null?void 0:d.output.scriptHash}}}}class C{_networkId;_encryptedSecret;constructor(e,t){this._networkId=e,this._encryptedSecret=t}getAccount(e,t){return this.accountContext(e,t,(s,a)=>{const i=me(this._networkId,s.to_public().hash(),a.to_public().hash()).to_address().to_bech32(),o=Ie(this._networkId,s.to_public().hash()).to_address().to_bech32(),c=Mt(this._networkId,a.to_public().hash()).to_address().to_bech32();return{baseAddress:i,enterpriseAddress:o,rewardAddress:c}})}signData(e,t,s,a){try{return this.accountContext(e,t,(i,o)=>{const c={payload:a},u={address:C.resolveAddress(this._networkId,s,i,o),key:s.startsWith("stake")?o:i},{coseSign1:d,coseKey:g}=os(c,u);return{signature:d,key:g}})}catch(i){throw new Error(`An error occurred during signData: ${i}.`)}}signTx(e,t,s,a,i){try{const o=Pe(qe(a));return this.accountContext(e,t,(c,u)=>{const d=n.Vkeywitnesses.new();return C.resolveSigners(a,s,c.to_public().hash().to_hex()).forEach(l=>{if(l===c.to_public().hash().to_hex())d.add(n.make_vkey_witness(o,c));else if(l===u.to_public().hash().to_hex())d.add(n.make_vkey_witness(o,u));else if(i===!1)throw new Error(`Missing key witness for: ${l}`)}),d})}catch(o){throw new Error(`An error occurred during signTx: ${o}.`)}}static encryptMnemonic(e,t){const s=Nt.mnemonicToEntropy(e.join(" ")),a=Oe(s),i=v(a.as_bytes());return a.free(),C.encrypt(i,t)}static encryptPrivateKey(e,t){const s=n.Bip32PrivateKey.from_bech32(e),a=v(s.as_bytes());return s.free(),C.encrypt(a,t)}static encryptSigningKeys(e,t,s){const a=C.encrypt(e.slice(4),s),i=C.encrypt(t.slice(4),s);return[a,i]}static generateMnemonic(e=256){return Nt.generateMnemonic(e).split(" ")}accountContext(e,t,s){const{paymentKey:a,stakeKey:i}=C.resolveKeys(e,t,this._encryptedSecret),o=s(a,i);return a.free(),i.free(),o}static decrypt(e,t){try{return n.decrypt_with_password(b(t),e)}catch{throw new Error("The password is incorrect.")}}static encrypt(e,t){const s=_e.customAlphabet("0123456789abcdef"),a=s(64),i=s(24);return n.encrypt_with_password(b(t),a,i,e)}static resolveAddress(e,t,s,a){const i=[me(e,s.to_public().hash(),a.to_public().hash()),Ie(e,s.to_public().hash()),Mt(e,a.to_public().hash())].find(o=>o.to_address().to_bech32()===t);if(i!==void 0)return i.to_address();throw new Error(`Address: ${t} doesn't belong to this account.`)}static resolveKeys(e,t,s){if(typeof s=="string"){const o=C.decrypt(s,t);return Us(o,e)}const a=C.decrypt(s[0],t),i=C.decrypt(s[1],t);return{paymentKey:n.PrivateKey.from_hex(a),stakeKey:n.PrivateKey.from_hex(i)}}static resolveSigners(e,t,s){const a=c=>{const u=(f,E=[],B=0)=>{var ft,lt,Yt,Gt,$t;if(f===void 0||B>=f.len())return E;const U=f.get(B),P=new Array;switch(U.kind()){case n.CertificateKind.StakeDeregistration:{const w=(ft=U.as_stake_deregistration())==null?void 0:ft.stake_credential(),R=(w==null?void 0:w.kind())===n.StakeCredKind.Key?w.to_keyhash():void 0;R&&P.push(R.to_hex());break}case n.CertificateKind.StakeDelegation:{const w=(lt=U.as_stake_delegation())==null?void 0:lt.stake_credential(),R=(w==null?void 0:w.kind())===n.StakeCredKind.Key?w.to_keyhash():void 0;R&&P.push(R.to_hex());break}case n.CertificateKind.PoolRegistration:{const w=(Yt=U.as_pool_registration())==null?void 0:Yt.pool_params().pool_owners();P.push(...g(w));break}case n.CertificateKind.PoolRetirement:{const w=(Gt=U.as_pool_retirement())==null?void 0:Gt.pool_keyhash();w&&P.push(w.to_hex());break}case n.CertificateKind.MoveInstantaneousRewardsCert:{const w=($t=U.as_move_instantaneous_rewards_cert())==null?void 0:$t.move_instantaneous_reward().as_to_stake_creds();if(w)for(let R=0;R<w.len();R+=1){const zt=w.keys().get(R),Wt=zt.kind()===n.StakeCredKind.Key?zt.to_keyhash():void 0;Wt&&P.push(Wt.to_hex())}break}}return u(f,[...E,...P],B+1)},d=(f,E=[],B=0)=>{if(f===void 0||B>=f.len())return E;const U=f.get(B).index(),P=f.get(B).transaction_id(),ft=t.find(lt=>lt.input.outputIndex===U&&lt.input.txHash===P.to_hex())!==void 0?s:"OUR_PRINCESS_IS_IN_ANOTHER_CASTLE";return d(f,[...E,ft],B+1)},g=(f,E=[],B=0)=>f===void 0||B>=f.len()?E:g(f,[...E,f.get(B).to_hex()],B+1),l=(f,E=[],B=0)=>{if(f===void 0||B>=f.len())return E;const U=f.keys().get(B).payment_cred(),P=U.kind()===n.StakeCredKind.Key?U.to_keyhash():void 0;return l(f,P?[...E,P.to_hex()]:E,B+1)},A=c.certs(),I=c.collateral(),x=c.inputs(),T=c.required_signers(),W=c.withdrawals();return[...u(A),...d(I),...d(x),...g(T),...l(W)]},i=c=>{const u=(g,l=[])=>{var A,I,x,T;if(g)for(let W=0;W<g.len();W+=1){const f=g.get(W);switch(f.kind()){case n.NativeScriptKind.ScriptPubkey:{const E=(A=f.as_script_pubkey())==null?void 0:A.addr_keyhash().to_hex();return E?[...l,E]:l}case n.NativeScriptKind.ScriptAll:return u((I=f.as_script_all())==null?void 0:I.native_scripts(),l);case n.NativeScriptKind.ScriptAny:return u((x=f.as_script_any())==null?void 0:x.native_scripts(),l);case n.NativeScriptKind.ScriptNOfK:return u((T=f.as_script_n_of_k())==null?void 0:T.native_scripts(),l)}}return l},d=c.native_scripts();return[...u(d)]},o=Y(e);return new Set([...a(o.body()),...i(o.witness_set())])}}const N="MARI0TIME";class Ar{_fetcher;_submitter;_wallet;constructor(e){switch(this._fetcher=e.fetcher,this._submitter=e.submitter,e.key.type){case"mnemonic":this._wallet=new C(e.networkId,C.encryptMnemonic(e.key.words,N));break;case"root":this._wallet=new C(e.networkId,C.encryptPrivateKey(e.key.bech32,N));break;case"cli":this._wallet=new C(e.networkId,C.encryptSigningKeys(e.key.payment,e.key.stake??"f0".repeat(34),N))}}getBaseAddress(e=0){return this._wallet.getAccount(e,N).baseAddress}getPaymentAddress(e=0){return this._wallet.getAccount(e,N).enterpriseAddress}getRewardAddress(e=0){return this._wallet.getAccount(e,N).rewardAddress}getUsedAddress(e=0){const t=this._wallet.getAccount(e,N);return K(t.enterpriseAddress)}getUsedCollateral(e=D.maxCollateralInputs){throw new Error("getUsedCollateral not implemented.")}async getUsedUTxOs(e=0){const t=this._wallet.getAccount(e,N);return(await this._fetcher.fetchAddressUTxOs(t.enterpriseAddress)).map(a=>H(a))}signData(e,t,s=0){try{return this._wallet.signData(s,N,e,t)}catch(a){throw new Error(`[AppWallet] An error occurred during signData: ${a}.`)}}async signTx(e,t=!1,s=0){try{const a=this._wallet.getAccount(s,N),i=await this._fetcher.fetchAddressUTxOs(a.enterpriseAddress),o=this._wallet.signTx(s,N,i,e,t),c=Y(e),u=c.witness_set(),d=Le(u,o);return u.set_vkeys(d),n.Transaction.new(c.body(),u,c.auxiliary_data()).to_hex()}catch(a){throw new Error(`[AppWallet] An error occurred during signTx: ${a}.`)}}submitTx(e){return this._submitter.submitTx(e)}static brew(e=256){return C.generateMnemonic(e)}}class vt{_walletInstance;constructor(e){this._walletInstance=e}static getInstalledWallets(){return window.cardano===void 0?[]:jt.filter(e=>window.cardano[e]!==void 0).map(e=>({name:window.cardano[e].name,icon:window.cardano[e].icon,version:window.cardano[e].apiVersion}))}static async enable(e){try{const t=await vt.resolveInstance(e);if(t!==void 0)return new vt(t);throw new Error(`Couldn't create an instance of wallet: ${e}`)}catch(t){throw new Error(`[BrowserWallet] An error occurred during enable: ${t}.`)}}async getBalance(){const e=await this._walletInstance.getBalance();return Fe(Vs(e))}async getChangeAddress(){const e=await this._walletInstance.getChangeAddress();return at(e).to_bech32()}async getCollateral(e=D.maxCollateralInputs){return(await this.getUsedCollateral(e)).map(s=>Qt(s))}getNetworkId(){return this._walletInstance.getNetworkId()}async getRewardAddresses(){return(await this._walletInstance.getRewardAddresses()).map(t=>at(t).to_bech32())}async getUnusedAddresses(){return(await this._walletInstance.getUnusedAddresses()).map(t=>at(t).to_bech32())}async getUsedAddresses(){return(await this._walletInstance.getUsedAddresses()).map(t=>at(t).to_bech32())}async getUtxos(){return(await this.getUsedUTxOs()).map(t=>Qt(t))}signData(e,t){const s=K(e).to_hex();return this._walletInstance.signData(s,b(t))}async signTx(e,t=!1){try{const s=Y(e),a=s.witness_set(),i=await this._walletInstance.signTx(e,t),o=Os(i).vkeys()??n.Vkeywitnesses.new(),c=Le(a,o);return a.set_vkeys(c),v(n.Transaction.new(s.body(),a,s.auxiliary_data()).to_bytes())}catch(s){throw new Error(`[BrowserWallet] An error occurred during signTx: ${JSON.stringify(s)}.`)}}submitTx(e){return this._walletInstance.submitTx(e)}async getUsedAddress(){const e=await this._walletInstance.getUsedAddresses();return at(e[0])}async getUsedCollateral(e=D.maxCollateralInputs){return(await this._walletInstance.experimental.getCollateral()??[]).map(s=>ge(s)).slice(0,e)}async getUsedUTxOs(){return(await this._walletInstance.getUtxos()??[]).map(t=>ge(t))}async getAssets(){return(await this.getBalance()).filter(t=>t.unit!=="lovelace").map(t=>{const s=t.unit.slice(0,O),a=t.unit.slice(O),i=Re(s,a);return{unit:t.unit,policyId:s,assetName:qt(a),fingerprint:i,quantity:t.quantity}})}async getLovelace(){const t=(await this.getBalance()).find(s=>s.unit==="lovelace");return t!==void 0?t.quantity:"0"}async getPolicyIdAssets(e){return(await this.getAssets()).filter(s=>s.policyId===e)}async getPolicyIds(){const e=await this.getBalance();return Array.from(new Set(e.map(t=>t.unit.slice(0,O)))).filter(t=>t!=="lovelace")}static resolveInstance(e){if(window.cardano===void 0)return;const t=jt.map(s=>window.cardano[s]).filter(s=>s!==void 0).find(s=>s.name.toLowerCase()===e.toLowerCase());return t==null?void 0:t.enable()}}const Ye="http://localhost:4000/",mr="http://localhost:5000/",Ir=`${Ye}access`,pr=`${Ye}transaction/signtx`;class fr{static getAxiosInstance(){return G.default.create({baseURL:mr,withCredentials:!0})}static getAppId(){return window.location.hostname}static async openMinaFrontend(e){const t=this.getAppId();e.includes("?")?e=`${e}&appId=${t}`:e=`${e}?appId=${t}`;const s="left=100,top=100,width=540,height=540",a=window.open(e,"meshWindow",s);return a||console.error("the window did not open",a),await(async()=>new Promise(i=>{window.addEventListener("message",async o=>{o.data.target=="minaWallet"&&i(o.data)})}))()}static async get(e,t={}){const s=this.getAppId();t={...t,appId:s};try{return(await this.getAxiosInstance().get(e,{params:t})).data}catch{console.error("Not logged in");return}}static async enable(){return await this.get("wallet/getuserwalletsmeta")===void 0?await this.openMinaFrontend(Ir):!0}static async getChangeAddress(e=void 0,t=void 0){return await this.get("wallet/getchangeaddress",{walletId:e,accountIndex:t})}static async getUtxos(e=void 0,t=void 0){return await this.get("wallet/getutxo",{walletId:e,accountIndex:t})}static async signTx(e,t=!1){const s=await this.get("wallet/getuserwalletsmeta");if(console.log("userWalletsMeta",s),s){const a=await this.openMinaFrontend(`${pr}?unsignedTx=${e}&partialSign=${t}`);if(a instanceof n.Vkeywitnesses){const i=Y(e),o=i.witness_set();o.set_vkeys(a);const c=n.Transaction.new(i.body(),o,i.auxiliary_data()).to_hex();return console.log("signedTx",c),c}}else return}}exports.AppWallet=Ar;exports.BlockfrostProvider=ar;exports.BrowserWallet=vt;exports.EmbeddedWallet=C;exports.ForgeScript=dr;exports.InfuraProvider=nr;exports.KoiosProvider=ir;exports.MaestroProvider=ur;exports.MeshTxBuilder=gr;exports.MinaWallet=fr;exports.OgmiosProvider=or;exports.TangoProvider=cr;exports.checkSignature=cs;exports.generateNonce=er;exports.isNetwork=ye;exports.keepRelevant=xe;exports.largestFirst=es;exports.largestFirstMultiAsset=Ce;exports.parseAssetUnit=z;exports.parseHttpError=h;exports.readPlutusData=sr;exports.readTransaction=rr;exports.resolveDataHash=Ys;exports.resolveEpochNo=Gs;exports.resolveFingerprint=Re;exports.resolveLanguageView=$s;exports.resolveNativeScriptHash=zs;exports.resolvePaymentKeyHash=st;exports.resolvePlutusScriptAddress=Ws;exports.resolvePlutusScriptHash=Js;exports.resolvePoolId=js;exports.resolvePrivateKey=Xs;exports.resolveRewardAddress=pt;exports.resolveScriptRef=Zs;exports.resolveSlotNo=tr;exports.resolveStakeKeyHash=it;exports.resolveTxFees=Lt;exports.resolveTxHash=qe;
